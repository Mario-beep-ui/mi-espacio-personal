<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Espacio Personal de Mario</title>
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Tailwind CSS CDN para estilos responsivos y modernos -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Variables de colores y estilos */
        :root {
            --primary-gradient-start: #4a6bff;
            --primary-gradient-end: #3a0ca3;
            --secondary-gradient-start: #4361ee;
            --secondary-gradient-end: #7209b7;
            --welcome-gradient-start: #3498db;
            --welcome-gradient-end: #8e44ad;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --white: #ffffff;
            --black: #000000;
            --success: #2ecc71;
            --error: #e74c3c;
            --warning: #f39c12;
            --info: #3498db;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        /* Reset y estilos generales */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa, #e6e9ff);
            color: #333;
            padding-top: 70px;
            padding-bottom: 50px;
            min-height: 100vh;
            line-height: 1.5;
        }

        /* Cabecera responsiva - FIXED */
        .site-header {
            position: fixed;
            top: 0;
            width: 100%;
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            box-shadow: var(--shadow);
            z-index: 1000;
            padding: 0 15px;
        }

        .site-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            min-height: 70px;
            padding: 10px 0;
        }

        .site-logo {
            color: white;
            font-size: 1.3rem;
            font-weight: bold;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .site-logo i {
            font-size: 1.5rem;
        }

        /* Menú hamburguesa para móviles */
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 10px;
        }

        .site-nav-links {
            display: flex;
            list-style: none;
        }

        .site-nav-links li {
            margin-left: 15px;
        }

        .site-nav-links a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            padding: 8px 15px;
            border-radius: 4px;
            transition: var(--transition);
            font-size: 1rem;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .site-nav-links a:hover, 
        .site-nav-links a.active {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        /* --- ESTILOS PARA MENÚ DESPLEGABLE "MÁS" --- */
        .more-menu-container {
            position: relative;
        }

        #more-menu-btn i {
            transition: transform 0.3s ease;
            font-size: 0.8em;
            margin-left: 5px;
        }

        #more-menu-btn.open i {
            transform: rotate(180deg);
        }

        .more-links-modal {
            display: none;
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            border-radius: var(--border-radius);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            list-style: none;
            padding: 10px 0;
            margin: 0;
            min-width: 220px;
            z-index: 1100;
            animation: fadeInModal 0.3s ease;
        }

        .more-links-modal.active {
            display: block;
        }

        @keyframes fadeInModal {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .more-links-modal li {
            margin: 0;
        }

        .more-links-modal li a {
            display: block;
            width: 100%;
            padding: 12px 20px;
            border-radius: 0;
        }
        /* --- FIN DE ESTILOS DE MENÚ DESPLEGABLE --- */

        /* Secciones responsivas */
        .section {
            display: none;
            max-width: 1200px;
            margin: 30px auto 60px;
            padding: 0 15px;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sección de Bienvenida */
        .welcome-container {
            text-align: center;
            padding: 60px 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        .gradient-text {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, var(--welcome-gradient-start), var(--welcome-gradient-end), var(--welcome-gradient-start));
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 8s ease infinite, pulse 2s ease infinite;
            margin-bottom: 25px;
            line-height: 1.2;
            padding: 0 10px;
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        .welcome-text {
            font-size: 1.3rem;
            color: #555;
            max-width: 800px;
            margin: 0 auto 40px;
            padding: 0 15px;
        }

        .welcome-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }

        .welcome-btn {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            color: white;
            border: none;
            border-radius: 50px;
            padding: 14px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(74, 107, 255, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 250px;
        }

        .welcome-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(74, 107, 255, 0.4);
        }

        /* Estilo genérico para cabeceras de sección */
        .espacio-header {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            border-radius: var(--border-radius);
            padding: 25px;
            color: white;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .espacio-header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .espacio-header p {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }
        
        /* Contenido "Próximamente" */
        .proximamente-container {
            text-align: center;
            padding: 60px 15px;
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .proximamente-container h2 {
            color: var(--primary-gradient-end);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .proximamente-container p {
            font-size: 1.1rem;
            color: #555;
        }

        /* Selector de pestañas general */
        .schedule-selector, .finance-category-selector, .routine-selector, .pending-category-selector {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 25px;
            gap: 15px;
        }

        .schedule-btn, .finance-category-btn, .routine-btn, .pending-btn {
            padding: 12px 25px;
            background-color: white;
            border: 2px solid var(--primary-gradient-start);
            border-radius: 30px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            color: var(--dark-gray);
            flex: 1;
            min-width: 150px; /* Adjusted for more buttons */
            max-width: 250px;
        }

        .schedule-btn.active, 
        .schedule-btn:hover,
        .finance-category-btn.active,
        .finance-category-btn:hover,
        .routine-btn.active,
        .routine-btn:hover,
        .pending-btn.active,
        .pending-btn:hover {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            color: white;
            border-color: transparent;
        }

        .schedule-container, .finance-section-content, .routine-content-container, .pending-section-content {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            margin-bottom: 30px;
            display: block;
        }

        .schedule-content, .routine-details, .pending-content {
            padding: 20px;
        }

        .day-columns {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .day-column {
            background-color: #f9f9f9;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .day-title {
            background: linear-gradient(135deg, var(--secondary-gradient-start), var(--secondary-gradient-end));
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .day-tasks {
            padding: 15px;
        }

        .task-item {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
        }

        .task-item:last-child {
            border-bottom: none;
        }

        .rest-day {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .rest-day h3 {
            color: var(--primary-gradient-end);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-gradient-start);
            font-size: 1.3rem;
        }

        .rest-day-item {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
            font-size: 1rem;
        }

        .rest-day-item::before {
            content: "•";
            position: absolute;
            left: 0;
            color: var(--primary-gradient-start);
            font-size: 1.5rem;
            top: -4px;
        }

        /* Sección de Préstamos Sam */
        .summary-card {
            background: linear-gradient(135deg, var(--secondary-gradient-start), var(--secondary-gradient-end));
            border-radius: var(--border-radius);
            padding: 25px;
            color: white;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .summary-card h2 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .summary-card .total-amount {
            font-size: 2.5rem;
            font-weight: 700;
        }

        .loans-container {
            overflow-x: auto;
            margin-bottom: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            max-width: 100%;
        }

        .loans-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: var(--white);
            min-width: 600px;
        }

        .loans-table thead {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            color: white;
        }

        .loans-table th {
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .loans-table td {
            padding: 14px 16px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            color: var(--dark-gray);
        }

        .loans-table tbody tr:last-child td {
            border-bottom: none;
        }

        .loans-table tbody tr:hover {
            background-color: rgba(74, 107, 255, 0.03);
        }

        .loan-amount {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--dark-gray);
        }

        .loan-concept {
            color: var(--dark-gray);
            font-size: 1rem;
        }

        .loan-date {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .loan-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .action-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            background: transparent;
            color: #6c757d;
            font-size: 1rem;
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .edit-btn:hover {
            background: rgba(52, 152, 219, 0.1);
            color: var(--info);
        }

        .delete-btn:hover {
            background: rgba(231, 76, 60, 0.1);
            color: var(--error);
        }

        .add-btn {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 20px auto;
            transition: var(--transition);
            box-shadow: 0 4px 10px rgba(74, 107, 255, 0.3);
            width: 100%;
            max-width: 300px;
        }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(74, 107, 255, 0.4);
        }

        .storage-info {
            text-align: center;
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 20px;
            padding: 0 15px;
        }

        /* Modal responsivo */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            padding: 15px;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-header h3 {
            font-size: 1.4rem;
            color: var(--dark-gray);
        }

        .close-modal {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            background: transparent;
            border: none;
            color: #6c757d;
            font-size: 1.3rem;
        }

        .close-modal:hover {
            background: rgba(0,0,0,0.05);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-gray);
            font-size: 1rem;
        }

        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary-gradient-start);
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 107, 255, 0.2);
        }

        .btn-submit {
            background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end));
            color: white;
            border: none;
            border-radius: 8px;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: var(--transition);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(74, 107, 255, 0.4);
        }

        /* Notificación */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 3000;
            transform: translateX(100%);
            opacity: 0;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 90%;
        }

        .notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--error);
        }

        .notification.info {
            background: var(--info);
        }

        .notification i {
            font-size: 1.3rem;
        }

        .notification span {
            font-size: 1rem;
        }

        /* Pie de página responsivo */
        footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: var(--primary-gradient-end);
            color: white;
            text-align: center;
            padding: 15px 0;
            font-size: 0.9rem;
            z-index: 100;
        }
        
        /* Modal para menú móvil */
        .mobile-menu-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85); /* Fondo más oscuro */
            z-index: 2000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .mobile-menu-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .mobile-menu-content {
            background: #2c3e50; /* Fondo sólido oscuro */
            width: 90%;
            max-width: 400px;
            border-radius: 10px;
            padding: 25px 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            max-height: 90vh;
            overflow-y: auto;
        }

        .mobile-nav-links {
            list-style: none;
            padding: 0;
        }

        .mobile-nav-links li {
            margin-bottom: 12px;
        }

        .mobile-nav-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            padding: 18px 15px;
            border-radius: 8px;
            font-size: 1.3rem;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.15);
            text-align: center;
        }

        .mobile-nav-links a i {
            margin-right: 12px;
            font-size: 1.2rem;
        }

        .mobile-nav-links a:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .mobile-nav-links a.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        .close-mobile-menu {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            z-index: 2100;
        }

        /* Clases para responsividad del menú */
        .mobile-only { display: none; }
        .desktop-only { display: list-item; }

        /* Estilos específicos para las nuevas secciones de finanzas y rutinas */
        .finance-section, .exercise-routine-section, .pending-section {
            background-color: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            margin-bottom: 30px; /* Espacio entre secciones */
        }

        .finance-controls {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .finance-controls label {
            font-weight: 500;
            color: var(--dark-gray);
        }

        .finance-controls input[type="date"] {
            flex-grow: 1;
            max-width: 180px;
        }

        /* Estilos para hacer las celdas de la tabla de deudas más anchas */
        #debts-table th,
        #debts-table td {
            min-width: 120px; /* Ancho mínimo para las celdas de fechas y cantidades */
            white-space: nowrap; /* Evita que el texto se envuelva en los encabezados */
        }

        #debts-table .amount-input {
            width: 100%; /* Asegura que el input ocupe todo el ancho de la celda */
            box-sizing: border-box; /* Incluye padding y border en el ancho total */
        }

        #debts-table .debt-checkbox {
            margin: 0 auto; /* Centrar checkbox */
            display: block;
        }

        /* Estilo para la fila de totales en la tabla de deudas */
        #debts-total-row tr {
            background-color: #e0e7ff; /* Un azul claro para destacar */
            font-weight: bold;
            color: var(--primary-gradient-end);
        }

        #debts-total-row td {
            padding: 15px 16px; /* Un poco más de padding */
            border-top: 2px solid var(--primary-gradient-start); /* Borde superior para separar */
        }

        /* Estilos para las rutinas de ejercicio */
        .routine-details h3 {
            color: var(--primary-gradient-end);
            margin-bottom: 15px;
            font-size: 1.6rem;
            border-bottom: 2px solid var(--primary-gradient-start);
            padding-bottom: 10px;
        }

        .routine-details p {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .exercise-list {
            list-style: none;
            padding: 0;
        }

        .exercise-item {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .exercise-item h4 {
            color: var(--secondary-gradient-end);
            margin-bottom: 8px;
            font-size: 1.2rem;
        }

        .exercise-item p {
            font-size: 0.95rem;
            color: #555;
            margin-bottom: 5px;
        }

        .exercise-item p strong {
            color: var(--dark-gray);
        }

        .additional-tips {
            background-color: #e0e7ff;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 30px;
            box-shadow: var(--shadow);
        }

        .additional-tips h3 {
            color: var(--primary-gradient-end);
            margin-bottom: 15px;
            font-size: 1.4rem;
            border-bottom: 2px solid var(--primary-gradient-start);
            padding-bottom: 10px;
        }

        .additional-tips ul {
            list-style: none;
            padding: 0;
        }

        .additional-tips li {
            margin-bottom: 10px;
            padding-left: 20px;
            position: relative;
            font-size: 1rem;
            color: #444;
        }

        .additional-tips li::before {
            content: "•";
            position: absolute;
            left: 0;
            color: var(--primary-gradient-start);
            font-size: 1.5rem;
            top: -4px;
        }

        /* Estilos para la sección de Pendientes (ahora es una tabla) */
        .pending-radio-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }
        .pending-radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: normal;
        }

        /* Estilos para el bloqueo de sección */
        .section-locked-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: var(--border-radius);
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .section-locked-overlay h2 {
            color: var(--primary-gradient-end);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .section-locked-overlay .form-group {
            max-width: 300px;
            width: 100%;
            margin-bottom: 15px;
        }

        .section-locked-overlay .form-control {
            text-align: center;
            font-size: 1.2rem;
            letter-spacing: 2px;
        }

        .section-locked-overlay .btn-submit {
            max-width: 250px;
            margin-top: 10px;
        }

        /* Estilos personalizados para la calculadora de transporte */
        .transport-calculator-main-container {
            background-color: #ffffff; /* Fondo blanco para el contenedor principal */
            border-radius: 1rem; /* Bordes redondeados */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* Sombra */
            padding: 2.5rem; /* Relleno interno */
            max-width: 90%; /* Ancho máximo responsivo */
            width: 950px; /* Ancho fijo para pantallas más grandes, ajustado para la nueva columna */
            margin-top: 20px; /* Margen superior */
        }
        /* Estilo para el indicador del calendario en inputs de tipo fecha */
        .transport-calculator-main-container input[type="date"]::-webkit-calendar-picker-indicator {
            filter: invert(0.5) sepia(1) saturate(5) hue-rotate(175deg); /* Ajusta el color del icono del calendario */
            cursor: pointer; /* Cursor de puntero */
        }
        /* Estilos personalizados para el modal de mensajes de la calculadora */
        .transport-message-modal {
            display: none; /* Oculto por defecto */
            position: fixed; /* Posición fija para superponerse a todo */
            z-index: 1000; /* Índice Z alto para estar encima de otros elementos */
            left: 0;
            top: 0;
            width: 100%; /* Ancho completo */
            height: 100%; /* Alto completo */
            overflow: auto; /* Habilitar scroll si es necesario */
            background-color: rgba(0,0,0,0.4); /* Fondo semi-transparente */
            justify-content: center; /* Centrar contenido horizontalmente */
            align-items: center; /* Centrar contenido verticalmente */
        }
        .transport-modal-content {
            background-color: #fefefe; /* Fondo blanco para el contenido del modal */
            margin: auto; /* Margen automático para centrar */
            padding: 20px; /* Relleno interno */
            border-radius: 0.75rem; /* Bordes redondeados */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); /* Sombra */
            max-width: 400px; /* Ancho máximo */
            width: 90%; /* Ancho responsivo */
            text-align: center; /* Texto centrado */
            position: relative; /* Posición relativa para el botón de cierre */
        }
        .transport-close-button {
            color: #aaa; /* Color del botón de cierre */
            float: right; /* Flotar a la derecha */
            font-size: 28px; /* Tamaño de fuente */
            font-weight: bold; /* Negrita */
            position: absolute; /* Posición absoluta */
            top: 10px; /* Distancia desde arriba */
            right: 15px; /* Distancia desde la derecha */
        }
        .transport-close-button:hover,
        .transport-close-button:focus {
            color: black; /* Color al pasar el ratón o enfocar */
            text-decoration: none; /* Sin subrayado */
            cursor: pointer; /* Cursor de puntero */
        }
        /* Estilos para el botón principal de la calculadora */
        .transport-button-primary {
            background-color: #4F46E5; /* Color índigo 600 */
            color: white; /* Texto blanco */
            padding: 0.75rem 1.5rem; /* Relleno */
            border-radius: 0.5rem; /* Bordes redondeados */
            font-weight: 600; /* Peso de fuente seminegrita */
            transition: background-color 0.3s ease; /* Transición suave al cambiar de color */
        }
        .transport-button-primary:hover {
            background-color: #4338CA; /* Color índigo 700 al pasar el ratón */
        }


        /* Media Queries para Responsividad */
        /* Modificaciones para el header en móviles */
        @media (max-width: 1024px) {
            .desktop-nav { display: none; }
            .menu-toggle { display: block; }
            
            .site-logo i {
                display: none; /* Ocultar ícono en móviles */
            }
            
            .site-logo {
                font-size: 1.2rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 150px;
            }
        }

        @media (max-width: 992px) {
            .gradient-text {
                font-size: 3rem;
            }
            
            .welcome-text {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
            
            .site-nav-links.desktop-nav {
                display: none;
            }
            
            .gradient-text {
                font-size: 2.5rem;
            }
            
            .welcome-btn {
                min-width: 100%;
                max-width: 300px;
            }
            
            .espacio-header h1 {
                font-size: 1.8rem;
            }
            
            .schedule-btn, .finance-category-btn, .routine-btn, .pending-btn {
                min-width: 100%;
                max-width: 300px;
            }
            
            .site-logo {
                font-size: 1.1rem;
                max-width: 130px;
            }
            
            .site-nav {
                min-height: 60px;
                padding: 8px 0;
            }

            .finance-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .finance-controls input[type="date"],
            .finance-controls .add-btn {
                max-width: 100%;
                width: 100%;
                margin-left: 0 !important;
            }

            .transport-calculator-main-container {
                padding: 1.5rem;
            }
            .transport-calculator-main-container h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 576px) {
            .gradient-text {
                font-size: 2.2rem;
            }
            
            .welcome-container {
                padding: 40px 10px;
            }
            
            .espacio-header {
                padding: 20px;
            }
            
            .espacio-header h1 {
                font-size: 1.6rem;
            }
            
            .task-item {
                font-size: 0.9rem;
            }
            
            .rest-day h3 {
                font-size: 1.2rem;
            }
            
            .rest-day-item {
                font-size: 0.9rem;
            }
            
            .summary-card {
                padding: 20px;
            }
            
            .summary-card h2 {
                font-size: 1.2rem;
            }
            
            .summary-card .total-amount {
                font-size: 2.2rem;
            }
            
            .loans-table th {
                padding: 14px;
                font-size: 1rem;
            }
            
            .loans-table td {
                padding: 12px 14px;
            }
            
            .loan-amount {
                font-size: 1.1rem;
            }
            
            .loan-concept {
                font-size: 0.95rem;
            }
            
            .loan-date {
                font-size: 0.85rem;
            }
            
            .action-btn {
                width: 34px;
                height: 34px;
                font-size: 0.95rem;
            }
            
            .add-btn {
                padding: 14px 25px;
                font-size: 1rem;
            }
            
            .modal-header {
                padding: 18px;
            }
            
            .modal-header h3 {
                font-size: 1.3rem;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .form-group label {
                font-size: 0.95rem;
            }
            
            .form-control {
                padding: 12px;
            }
            
            .btn-submit {
                padding: 14px;
            }

            .transport-calculator-main-container h1 {
                font-size: 1.8rem;
            }
            .transport-calculator-main-container .text-2xl {
                font-size: 1.5rem;
            }
            .transport-calculator-main-container .text-lg {
                font-size: 1rem;
            }
            .transport-calculator-main-container .button-primary {
                font-size: 1rem;
                padding: 12px 20px;
            }
        }

        @media (max-width: 400px) {
            .gradient-text {
                font-size: 1.8rem;
            }
            
            .site-logo {
                font-size: 1rem;
                max-width: 110px;
            }
            
            .welcome-text {
                font-size: 1.1rem;
            }
            
            .mobile-nav-links a {
                font-size: 1.2rem;
                padding: 16px 12px;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 md:p-8">
    <header class="site-header">
        <nav class="site-nav">
            <div class="site-logo">
                <i class="fas fa-user-circle"></i>
                Espacio Personal
            </div>
            <button class="menu-toggle" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <ul class="site-nav-links desktop-nav" id="nav-links">
                <!-- NAVEGACIÓN PRINCIPAL -->
                <li><a href="#" class="nav-link active" data-target="home"><i class="fas fa-home"></i>Inicio</a></li>
                <li><a href="#" class="nav-link" data-target="schedules"><i class="fas fa-calendar-alt"></i>Horarios</a></li>
                <li><a href="#" class="nav-link" data-target="finanzas"><i class="fas fa-chart-line"></i>Finanzas</a></li>
                <li><a href="#" class="nav-link" data-target="loans"><i class="fas fa-hand-holding-usd"></i>Préstamos Sam</a></li>

                <!-- MENÚ "MÁS" -->
                <li class="more-menu-container desktop-only">
                    <a href="#" id="more-menu-btn" class="nav-link">Más <i class="fas fa-chevron-down"></i></a>
                    <ul class="more-links-modal" id="more-links-modal">
                        <li><a href="#" class="nav-link" data-target="projects"><i class="fas fa-folder-open"></i>Proyectos</a></li>
                        <li><a href="#" class="nav-link" data-target="cxc"><i class="fas fa-file-invoice-dollar"></i>CxC</a></li>
                        <li><a href="#" class="nav-link" data-target="exercise-routines"><i class="fas fa-dumbbell"></i>Rutinas de Ejercicio</a></li>
                        <li><a href="#" class="nav-link" data-target="transport-calculator"><i class="fas fa-bus"></i>Calculadora Transporte</a></li>
                        <li><a href="#" class="nav-link" data-target="pendientes"><i class="fas fa-tasks"></i>Pendientes</a></li>
                        <li><a href="#" class="nav-link" data-target="por-hacer-sam"><i class="fas fa-heart"></i>Por Hacer con Sam</a></li>
                        <li><a href="#" class="nav-link" data-target="gustos-sam"><i class="fas fa-gift"></i>Gustos Sam</a></li>
                        <li><a href="#" class="nav-link" data-target="compras"><i class="fas fa-shopping-cart"></i>Compras Generales</a></li>
                        <li><a href="#" class="nav-link" data-target="fechas"><i class="fas fa-star"></i>Fechas Importantes</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>

    <!-- Modal para menú móvil -->
    <div class="mobile-menu-modal" id="mobile-menu-modal">
        <button class="close-mobile-menu" id="close-mobile-menu">
            <i class="fas fa-times"></i>
        </button>
        <div class="mobile-menu-content">
            <ul class="mobile-nav-links" id="mobile-nav-links">
                <li><a href="#" class="nav-link active" data-target="home"><i class="fas fa-home"></i>Inicio</a></li>
                <li><a href="#" class="nav-link" data-target="schedules"><i class="fas fa-calendar-alt"></i>Horarios</a></li>
                <li><a href="#" class="nav-link" data-target="finanzas"><i class="fas fa-chart-line"></i>Finanzas</a></li>
                <li><a href="#" class="nav-link" data-target="loans"><i class="fas fa-hand-holding-usd"></i>Préstamos Sam</a></li>
                <li><a href="#" class="nav-link" data-target="projects"><i class="fas fa-folder-open"></i>Proyectos</a></li>
                <li><a href="#" class="nav-link" data-target="cxc"><i class="fas fa-file-invoice-dollar"></i>CxC</a></li>
                <li><a href="#" class="nav-link" data-target="exercise-routines"><i class="fas fa-dumbbell"></i>Rutinas de Ejercicio</a></li>
                <li><a href="#" class="nav-link" data-target="transport-calculator"><i class="fas fa-bus"></i>Calculadora Transporte</a></li>
                <li><a href="#" class="nav-link" data-target="pendientes"><i class="fas fa-tasks"></i>Pendientes</a></li>
                <li><a href="#" class="nav-link" data-target="por-hacer-sam"><i class="fas fa-heart"></i>Por Hacer con Sam</a></li>
                <li><a href="#" class="nav-link" data-target="gustos-sam"><i class="fas fa-gift"></i>Gustos Sam</a></li>
                <li><a href="#" class="nav-link" data-target="compras"><i class="fas fa-shopping-cart"></i>Compras Generales</a></li>
                <li><a href="#" class="nav-link" data-target="fechas"><i class="fas fa-star"></i>Fechas Importantes</a></li>
            </ul>
        </div>
    </div>

    <section id="home" class="section active">
        <div class="welcome-container">
            <h1 class="gradient-text">Bienvenido a tu espacio personal Mario</h1>
            <p class="welcome-text">Este es tu espacio personal donde podrás organizar tus horarios, proyectos y metas. Aquí encontrarás todo lo necesario para mantener tu rutina organizada y alcanzar tus objetivos.</p>
            <div class="welcome-buttons">
                <button class="welcome-btn" data-target="schedules">
                    <i class="fas fa-calendar-alt"></i>Ver Mis Horarios
                </button>
                <button class="welcome-btn" data-target="loans">
                    <i class="fas fa-hand-holding-usd"></i>Préstamos Sam
                </button>
            </div>
        </div>
    </section>

    <section id="schedules" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-calendar-alt"></i>Mis Horarios</h1>
            <p>Organiza tu tiempo y mantén tu rutina bajo control</p>
        </div>

        <div class="schedule-selector">
            <button class="schedule-btn active" data-schedule="morning">Horario de Mañana</button>
            <button class="schedule-btn" data-schedule="afternoon">Horario de Tarde</button>
        </div>
        
        <div class="schedule-container morning-schedule">
            <div class="schedule-content">
                <div class="day-columns">
                    <div class="day-column">
                        <div class="day-title">LUNES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 4:40 AM</div>
                            <div class="task-item">- 10 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- BAÑARME</div>
                            <div class="task-item">- SALIR A TRABAJAR A LAS 5:20 AM</div>
                            <div class="task-item">- SALIR DE TRABAJAR A LAS 3:00 PM</div>
                            <div class="task-item">- LLEGAR A CASA A LAS 4:30 PM</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 4:55 PM A 6:20 PM</div>
                            <div class="task-item">- SALIR CON SAM A LAS 6:25 PM</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:30 PM</div>
                            <div class="task-item">- PREPARAR TODO PARA MAÑANA EN 10 MINUTOS</div>
                            <div class="task-item">- DORMIR ENTRE 11:45 Y 11:50 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">MARTES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 4:40 AM</div>
                            <div class="task-item">- 10 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- BAÑARME</div>
                            <div class="task-item">- SALIR A TRABAJAR A LAS 5:20 AM</div>
                            <div class="task-item">- SALIR DE TRABAJAR A LAS 3:00 PM</div>
                            <div class="task-item">- LLEGAR A CASA A LAS 4:30 PM</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 5:00 PM A 8:00 PM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:00 PM A 9:15 PM</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 9:15 PM A 10:30 PM</div>
                            <div class="task-item">- PREPARAR TODO PARA DORMIR</div>
                            <div class="task-item">- DORMIR DE 10:50 A 11:00 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">MIÉRCOLES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 4:40 AM</div>
                            <div class="task-item">- 10 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- BAÑARME</div>
                            <div class="task-item">- SALIR A TRABAJAR A LAS 5:20 AM</div>
                            <div class="task-item">- SALIR DE TRABAJAR A LAS 3:00 PM</div>
                            <div class="task-item">- LLEGAR A CASA A LAS 4:30 PM</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 4:55 PM A 6:20 PM</div>
                            <div class="task-item">- SALIR CON SAM A LAS 6:25 PM</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:30 PM</div>
                            <div class="task-item">- PREPARAR TODO PARA MAÑANA EN 10 MINUTOS</div>
                            <div class="task-item">- DORMIR ENTRE 11:45 Y 11:50 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">JUEVES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 4:40 AM</div>
                            <div class="task-item">- 10 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- BAÑARME</div>
                            <div class="task-item">- SALIR A TRABAJAR A LAS 5:20 AM</div>
                            <div class="task-item">- SALIR DE TRABAJAR A LAS 3:00 PM</div>
                            <div class="task-item">- LLEGAR A CASA A LAS 4:30 PM</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 5:00 PM A 8:00 PM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:00 PM A 9:15 PM</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 9:15 PM A 10:30 PM</div>
                            <div class="task-item">- PREPARAR TODO PARA DORMIR</div>
                            <div class="task-item">- DORMIR DE 10:50 A 11:00 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">VIERNES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 4:40 AM</div>
                            <div class="task-item">- 10 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- BAÑARME</div>
                            <div class="task-item">- SALIR A TRABAJAR A LAS 5:20 AM</div>
                            <div class="task-item">- SALIR DE TRABAJAR A LAS 3:00 PM</div>
                            <div class="task-item">- LLEGAR A CASA A LAS 4:30 PM</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 4:55 PM A 6:20 PM</div>
                            <div class="task-item">- SALIR CON SAM A LAS 6:25 PM</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:30 PM</div>
                            <div class="task-item">- PREPARAR TODO PARA MAÑANA EN 10 MINUTOS</div>
                            <div class="task-item">- DORMIR ENTRE 11:45 Y 11:50 PM</div>
                        </div>
                    </div>
                </div>
                
                <div class="rest-day">
                    <h3>Días de Descanso</h3>
                    <div class="rest-day-item">- CUANDO DESCANSO DE LUNES A VIERNES LEVANTARME A LAS 6 AM</div>
                    <div class="rest-day-item">- LAVAR, RECOGER ESCRITORIO, EJERCICIO, DOBLAR ROPA, ESTUDIAR</div>
                    <div class="rest-day-item">- SALIR CON SAM A LAS 3 PM</div>
                    <div class="rest-day-item">- REGRESAR CON SAM A LAS 10:20 PM</div>
                </div>
            </div>
        </div>
        
        <div class="schedule-container afternoon-schedule" style="display: none;">
            <div class="schedule-content">
                <div class="day-columns">
                    <div class="day-column">
                        <div class="day-title">LUNES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 5:50 AM</div>
                            <div class="task-item">- 5 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- 15 MINUTOS DE EJERCICIO</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 6:10 AM A 8:45 AM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:50 AM A 9:50 AM</div>
                            <div class="task-item">- 20 MINUTOS PARA COMER</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 10:15 AM A 11:30 AM</div>
                            <div class="task-item">- PREPARAR TODO PARA EL TRABAJO, BAÑARME</div>
                            <div class="task-item">- SALIR A LAS 12:30 PM AL CAMIÓN</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:00 PM</div>
                            <div class="task-item">- DORMIR A LAS 11:30 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">MARTES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 5:50 AM</div>
                            <div class="task-item">- 5 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- 15 MINUTOS DE EJERCICIO</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 6:10 AM A 8:45 AM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:50 AM A 9:50 AM</div>
                            <div class="task-item">- 20 MINUTOS PARA COMER</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 10:15 AM A 11:30 AM</div>
                            <div class="task-item">- PREPARAR TODO PARA EL TRABAJO, BAÑARME</div>
                            <div class="task-item">- SALIR A LAS 12:30 PM AL CAMIÓN</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:00 PM</div>
                            <div class="task-item">- DORMIR A LAS 11:30 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">MIÉRCOLES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 5:50 AM</div>
                            <div class="task-item">- 5 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- 15 MINUTOS DE EJERCICIO</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 6:10 AM A 8:45 AM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:50 AM A 9:50 AM</div>
                            <div class="task-item">- 20 MINUTOS PARA COMER</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 10:15 AM A 11:30 AM</div>
                            <div class="task-item">- PREPARAR TODO PARA EL TRABAJO, BAÑARME</div>
                            <div class="task-item">- SALIR A LAS 12:30 PM AL CAMIÓN</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:00 PM</div>
                            <div class="task-item">- DORMIR A LAS 11:30 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">JUEVES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 5:50 AM</div>
                            <div class="task-item">- 5 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- 15 MINUTOS DE EJERCICIO</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 6:10 AM A 8:45 AM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:50 AM A 9:50 AM</div>
                            <div class="task-item">- 20 MINUTOS PARA COMER</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 10:15 AM A 11:30 AM</div>
                            <div class="task-item">- PREPARAR TODO PARA EL TRABAJO, BAÑARME</div>
                            <div class="task-item">- SALIR A LAS 12:30 PM AL CAMIÓN</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:00 PM</div>
                            <div class="task-item">- DORMIR A LAS 11:30 PM</div>
                        </div>
                    </div>
                    
                    <div class="day-column">
                        <div class="day-title">VIERNES</div>
                        <div class="day-tasks">
                            <div class="task-item">- LEVANTARME A LAS 5:50 AM</div>
                            <div class="task-item">- 5 MINUTOS PARA DESPERTAR</div>
                            <div class="task-item">- 15 MINUTOS DE EJERCICIO</div>
                            <div class="task-item">- ESTUDIAR PROGRAMACIÓN DE 6:10 AM A 8:45 AM</div>
                            <div class="task-item">- ESTUDIAR INGLÉS DE 8:50 AM A 9:50 AM</div>
                            <div class="task-item">- 20 MINUTOS PARA COMER</div>
                            <div class="task-item">- ESTUDIAR MATEMÁTICAS DE 10:15 AM A 11:30 AM</div>
                            <div class="task-item">- PREPARAR TODO PARA EL TRABAJO, BAÑARME</div>
                            <div class="task-item">- SALIR A LAS 12:30 PM AL CAMIÓN</div>
                            <div class="task-item">- REGRESAR A CASA A LAS 11:00 PM</div>
                            <div class="task-item">- DORMIR A LAS 11:30 PM</div>
                        </div>
                    </div>
                </div>
                
                <div class="rest-day">
                    <h3>Días de Descanso</h3>
                    <div class="rest-day-item">- LEVANTARME A LAS 6 AM</div>
                    <div class="rest-day-item">- LAVAR Y HACER PENDIENTES</div>
                    <div class="rest-day-item">- ESTUDIAR PROGRAMACIÓN DE 8:40 AM A 10:40 PM</div>
                    <div class="rest-day-item">- COMER EN 20 MINUTOS</div>
                    <div class="rest-day-item">- PAUSA DE 30 MINUTOS</div>
                    <div class="rest-day-item">- ESTUDIAR INGLÉS DE 11:30 AM A 12:40 PM</div>
                    <div class="rest-day-item">- ESTUDIAR MATEMÁTICAS DE 12:40 PM A 1:55 PM</div>
                    <div class="rest-day-item">- BAÑARME PARA SALIR CON SAM A LAS 2:20 PM</div>
                    <div class="rest-day-item">- REGRESAR A CASA A LAS 11 PM</div>
                    <div class="rest-day-item">- DORMIR A LAS 11:30 PM</div>
                </div>
            </div>
        </div>
    </section>

    <section id="loans" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-hand-holding-usd"></i>Préstamos Sam & Pareja</h1>
            <p>Registro de préstamos entre parejas</p>
        </div>

        <!-- Contenedor principal de la sección de préstamos -->
        <div class="container" id="loans-section-content">
            <!-- Overlay de bloqueo -->
            <div class="section-locked-overlay" id="loans-lock-overlay">
                <h2>Sección Bloqueada</h2>
                <p style="margin-bottom: 25px; color: #555;">Introduce el PIN para acceder a esta sección.</p>
                <div class="form-group">
                    <label for="pin-input">PIN:</label>
                    <input type="password" id="pin-input" class="form-control" maxlength="4" placeholder="****">
                </div>
                <button class="btn-submit" id="unlock-loans-btn">
                    <i class="fas fa-lock-open"></i> Desbloquear Sección
                </button>
            </div>

            <!-- Contenido real de la sección de préstamos (inicialmente oculto) -->
            <div id="loans-content-wrapper" style="display: none;">
                <div class="summary-card">
                    <h2>Total prestado</h2>
                    <div class="total-amount">$0.00</div>
                </div>

                <div class="loans-container">
                    <table class="loans-table">
                        <thead>
                            <tr>
                                <th>Cantidad</th>
                                <th>Concepto</th>
                                <th>Fecha</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="loans-list">
                            <!-- Datos se cargarán dinámicamente -->
                        </tbody>
                    </table>
                </div>

                <button class="add-btn" id="open-modal">
                    <i class="fas fa-plus-circle"></i>Agregar préstamo Sam
                </button>

                <div class="storage-info">
                    <i class="fas fa-database"></i> Datos guardados en tu navegador
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Cuentas por Cobrar (CxC) -->
    <section id="cxc" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-file-invoice-dollar"></i>Cuentas por Cobrar</h1>
            <p>Gestión de tus cuentas por cobrar</p>
        </div>

        <div class="container">
            <div class="summary-card">
                <h2>Total por cobrar</h2>
                <div class="total-amount" id="total-cxc-display">$0.00</div>
            </div>

            <div class="loans-container">
                <table class="loans-table">
                    <thead>
                        <tr>
                            <th>Semana</th>
                            <th>Importe</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="cxc-list">
                        <!-- Datos se cargarán dinámicamente desde JS y localStorage -->
                    </tbody>
                </table>
            </div>

            <button class="add-btn" id="add-cxc-btn">
                <i class="fas fa-plus-circle"></i>Añadir CxC
            </button>

            <div class="storage-info">
                <i class="fas fa-database"></i> Datos guardados en tu navegador
            </div>
        </div>
    </section>

    <section id="projects" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-folder-open"></i>Mis Proyectos</h1>
            <p>Aquí encontrarás todos mis proyectos personales</p>
        </div>
        <div class="proximamente-container">
            <h2>Próximamente...</h2>
            <p>Esta sección está en desarrollo. ¡Vuelve pronto!</p>
        </div>
    </section>

    <section id="exercise-routines" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-dumbbell"></i>Rutinas de Ejercicio</h1>
            <p>¡Entrena en casa con estas rutinas de 20 minutos!</p>
        </div>
        <div class="container exercise-routine-section">
            <p style="margin-bottom: 20px; font-size: 1.1rem; color: #555;">¡Claro! Aquí tienes tres rutinas de 20 minutos cada una, diseñadas para trabajar brazos, hombros, pecho, abdomen y piernas, utilizando únicamente tu peso corporal. Recuerda calentar unos 5 minutos antes de cada rutina y estirar al finalizar.</p>

            <div class="routine-selector">
                <button class="routine-btn active" data-routine="upper-body">Parte Superior</button>
                <button class="routine-btn" data-routine="core">Intermedio</button>
                <button class="routine-btn" data-routine="lower-body">Parte Inferior</button>
            </div>

            <div class="routine-content-container upper-body-routine">
                <div class="routine-details">
                    <h3>Rutina 1: Brazos, Hombros y Pecho (20 minutos)</h3>
                    <p>Realiza cada ejercicio durante 45 segundos, seguido de 15 segundos de descanso. Completa 3 rondas de todos los ejercicios.</p>
                    <ul class="exercise-list">
                        <li class="exercise-item">
                            <h4>Flexiones (Push-ups)</h4>
                            <p><strong>Cómo hacerlas:</strong> Colócate boca abajo con las manos un poco más anchas que los hombros. Baja el pecho hacia el suelo, manteniendo el cuerpo recto, y luego empuja hacia arriba. Si es muy difícil, apoya las rodillas en el suelo.</p>
                            <p><strong>Enfoque:</strong> Pecho, hombros, tríceps.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Fondos en Silla (Triceps Dips - si tienes una silla estable)</h4>
                            <p><strong>Cómo hacerlos:</strong> Si tienes una silla o banco estable, siéntate en el borde y coloca las manos a los lados de tus caderas, con los dedos apuntando hacia adelante. Desliza las caderas fuera de la silla y baja el cuerpo doblando los codos a 90 grados. Empuja hacia arriba para volver a la posición inicial. Si no tienes una silla, puedes omitir este ejercicio o hacer flexiones más cerradas.</p>
                            <p><strong>Enfoque:</strong> Tríceps, hombros.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Flexiones Inclinadas (Incline Push-ups)</h4>
                            <p><strong>Cómo hacerlas:</strong> Coloca las manos en una superficie elevada (una pared, una mesa baja, un escalón). Cuanto más alta sea la superficie, más fácil será el ejercicio. Realiza las flexiones como de costumbre.</p>
                            <p><strong>Enfoque:</strong> Pecho, hombros.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Pike Push-ups (Flexiones de Pica)</h4>
                            <p><strong>Cómo hacerlas:</strong> Empieza en una posición de plancha alta, luego levanta las caderas hacia el techo formando una "V" invertida con tu cuerpo. Baja la cabeza hacia el suelo doblando los codos, como si quisieras tocar el suelo con la coronilla, y luego empuja hacia arriba.</p>
                            <p><strong>Enfoque:</strong> Hombros.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Plancha con Toque de Hombro (Shoulder Tap Plank)</h4>
                            <p><strong>Cómo hacerlas:</strong> Colócate en posición de plancha alta (manos debajo de los hombros, cuerpo recto). Sin mover las caderas, levanta una mano y toca el hombro opuesto. Alterna los lados.</p>
                            <p><strong>Enfoque:</strong> Hombros, core.</p>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="routine-content-container core-routine" style="display: none;">
                <div class="routine-details">
                    <h3>Rutina 2: Abdomen (20 minutos)</h3>
                    <p>Realiza cada ejercicio durante 45 segundos, seguido de 15 segundos de descanso. Completa 3 rondas de todos los ejercicios.</p>
                    <ul class="exercise-list">
                        <li class="exercise-item">
                            <h4>Crunches (Encogimientos)</h4>
                            <p><strong>Cómo hacerlos:</strong> Acuéstate boca arriba con las rodillas flexionadas y los pies apoyados en el suelo. Coloca las manos detrás de la cabeza o cruzadas sobre el pecho. Levanta la parte superior del cuerpo hacia las rodillas, contrayendo el abdomen, y luego baja lentamente.</p>
                            <p><strong>Enfoque:</strong> Abdomen superior.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Elevación de Piernas (Leg Raises)</h4>
                            <p><strong>Cómo hacerlas:</strong> Acuéstate boca arriba con las piernas estiradas. Puedes colocar las manos debajo de los glúteos para mayor soporte lumbar. Levanta las piernas rectas hacia el techo hasta que formen un ángulo de 90 grados con tu cuerpo, y luego bájalas lentamente sin tocar el suelo.</p>
                            <p><strong>Enfoque:</strong> Abdomen inferior.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Plancha (Plank)</h4>
                            <p><strong>Cómo hacerla:</strong> Colócate boca abajo, apoyándote en los antebrazos y las puntas de los pies. Mantén el cuerpo recto desde la cabeza hasta los talones, contrayendo el abdomen y los glúteos. Evita que las caderas se caigan o se eleven demasiado.</p>
                            <p><strong>Enfoque:</strong> Core completo.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Giros Rusos (Russian Twists)</h4>
                            <p><strong>Cómo hacerlos:</strong> Siéntate en el suelo con las rodillas flexionadas y los pies ligeramente levantados (o apoyados si es muy difícil). Inclina el torso ligeramente hacia atrás, manteniendo la espalda recta. Gira el torso de un lado a otro, tocando el suelo con las manos a cada lado (o simplemente moviendo los brazos).</p>
                            <p><strong>Enfoque:</strong> Oblicuos.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Bicicletas (Bicycle Crunches)</h4>
                            <p><strong>Cómo hacerlas:</strong> Acuéstate boca arriba con las manos detrás de la cabeza. Lleva una rodilla hacia el pecho mientras extiendes la otra pierna, y al mismo tiempo, lleva el codo opuesto hacia la rodilla que se flexiona. Alterna los lados, como si pedaleara una bicicleta.</p>
                            <p><strong>Enfoque:</strong> Abdomen superior e inferior, oblicuos.</p>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="routine-content-container lower-body-routine" style="display: none;">
                <div class="routine-details">
                    <h3>Rutina 3: Piernas (20 minutos)</h3>
                    <p>Realiza cada ejercicio durante 45 segundos, seguido de 15 segundos de descanso. Completa 3 rondas de todos los ejercicios.</p>
                    <ul class="exercise-list">
                        <li class="exercise-item">
                            <h4>Sentadillas (Squats)</h4>
                            <p><strong>Cómo hacerlas:</strong> Ponte de pie con los pies al ancho de los hombros. Baja las caderas como si fueras a sentarte en una silla, manteniendo la espalda recta y el pecho erguido. Asegúrate de que tus rodillas no sobrepasen los dedos de tus pies. Vuelve a la posición inicial.</p>
                            <p><strong>Enfoque:</strong> Cuádriceps, glúteos, isquiotibiales.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Zancadas (Lunges)</h4>
                            <p><strong>Cómo hacerlas:</strong> Ponte de pie con los pies juntos. Da un paso largo hacia adelante con una pierna y baja las caderas hasta que ambas rodillas formen un ángulo de 90 grados. La rodilla trasera debe casi tocar el suelo y la rodilla delantera debe estar alineada con el tobillo. Empuja con la pierna delantera para volver a la posición inicial. Alterna las piernas.</p>
                            <p><strong>Enfoque:</strong> Cuádriceps, glúteos, isquiotibiales.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Puente de Glúteos (Glute Bridges)</h4>
                            <p><strong>Cómo hacerlos:</strong> Acuéstate boca arriba con las rodillas flexionadas y los pies apoyados en el suelo, cerca de los glúteos. Levanta las caderas del suelo hasta que tu cuerpo forme una línea recta desde los hombros hasta las rodillas. Contrae los glúteos en la parte superior y baja lentamente.</p>
                            <p><strong>Enfoque:</strong> Glúteos, isquiotibiales.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Sentadilla Búlgara (Bulgarian Split Squats - con una silla estable)</h4>
                            <p><strong>Cómo hacerlas:</strong> Ponte de espaldas a una silla o banco bajo. Coloca el empeine de un pie sobre la silla, dejando la otra pierna adelante. Baja el cuerpo flexionando la rodilla delantera hasta que el muslo esté paralelo al suelo. Empuja hacia arriba para volver. Haz 45 segundos con una pierna y en la siguiente ronda, cambia de pierna.</p>
                            <p><strong>Enfoque:</strong> Cuádriceps, glúteos, isquiotibiales, equilibrio.</p>
                        </li>
                        <li class="exercise-item">
                            <h4>Elevación de Gemelos (Calf Raises)</h4>
                            <p><strong>Cómo hacerlas:</strong> Ponte de pie con los pies al ancho de los hombros. Levanta los talones del suelo, poniéndote de puntillas, y luego baja lentamente. Puedes hacerlo con ambos pies a la vez o alternando.</p>
                            <p><strong>Enfoque:</strong> Gemelos.</p>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="additional-tips">
                <h3>Consejos Adicionales:</h3>
                <ul>
                    <li><strong>Escucha a tu cuerpo:</strong> Si sientes dolor, detente.</li>
                    <li><strong>Hidratación:</strong> Bebe agua antes, durante y después del ejercicio.</li>
                    <li><strong>Progresión:</strong> A medida que te fortalezcas, puedes aumentar el tiempo de trabajo, disminuir el tiempo de descanso, o aumentar el número de rondas.</li>
                    <li><strong>Consistencia:</strong> La clave para ver resultados es ser constante. Intenta hacer estas rutinas 3-4 veces por semana.</li>
                </ul>
                <p style="margin-top: 20px; text-align: center; font-style: italic; color: #666;">¡Espero que disfrutes estas rutinas!</p>
            </div>
        </div>
    </section>

    <section id="pendientes" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-tasks"></i>Pendientes</h1>
            <p>Lista de tareas y asuntos pendientes</p>
        </div>
        <div class="container pending-section">
            <div class="pending-category-selector">
                <button class="pending-btn active" data-pending-category="personales">Personales</button>
                <button class="pending-btn" data-pending-category="escolares">Escolares</button>
                <button class="pending-btn" data-pending-category="trabajo">Trabajo</button>
                <button class="pending-btn" data-pending-category="financieros">Financieros</button>
            </div>

            <!-- Sección de Pendientes Personales -->
            <div class="pending-section-content personales-pendings-content">
                <div class="pending-content">
                    <h3>Pendientes Personales</h3>
                    <div class="loans-container">
                        <table class="loans-table">
                            <thead>
                                <tr>
                                    <th>Pendiente</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="personales-pendings-list">
                                <!-- Pendientes personales se cargarán aquí -->
                            </tbody>
                        </table>
                    </div>
                    <button class="add-btn" id="add-personal-pending-btn" style="width: auto; margin-top: 20px;">
                        <i class="fas fa-plus-circle"></i>Agregar Pendiente Personal
                    </button>
                </div>
            </div>

            <!-- Sección de Pendientes Escolares -->
            <div class="pending-section-content escolares-pendings-content" style="display: none;">
                <div class="pending-content">
                    <h3>Pendientes Escolares</h3>
                    <div class="loans-container">
                        <table class="loans-table">
                            <thead>
                                <tr>
                                    <th>Pendiente</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="escolares-pendings-list">
                                <!-- Pendientes escolares se cargarán aquí -->
                            </tbody>
                        </table>
                    </div>
                    <button class="add-btn" id="add-escolar-pending-btn" style="width: auto; margin-top: 20px;">
                        <i class="fas fa-plus-circle"></i>Agregar Pendiente Escolar
                    </button>
                </div>
            </div>

            <!-- Sección de Pendientes de Trabajo -->
            <div class="pending-section-content trabajo-pendings-content" style="display: none;">
                <div class="pending-content">
                    <h3>Pendientes de Trabajo</h3>
                    <div class="loans-container">
                        <table class="loans-table">
                            <thead>
                                <tr>
                                    <th>Pendiente</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="trabajo-pendings-list">
                                <!-- Pendientes de trabajo se cargarán aquí -->
                            </tbody>
                        </table>
                    </div>
                    <button class="add-btn" id="add-trabajo-pending-btn" style="width: auto; margin-top: 20px;">
                        <i class="fas fa-plus-circle"></i>Agregar Pendiente de Trabajo
                    </button>
                </div>
            </div>

            <!-- Sección de Pendientes Financieros -->
            <div class="pending-section-content financieros-pendings-content" style="display: none;">
                <div class="pending-content">
                    <h3>Pendientes Financieros</h3>
                    <div class="loans-container">
                        <table class="loans-table">
                            <thead>
                                <tr>
                                    <th>Pendiente</th>
                                    <th>Fecha</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="financieros-pendings-list">
                                <!-- Pendientes financieros se cargarán aquí -->
                            </tbody>
                        </table>
                    </div>
                    <button class="add-btn" id="add-financiero-pending-btn" style="width: auto; margin-top: 20px;">
                        <i class="fas fa-plus-circle"></i>Agregar Pendiente Financiero
                    </button>
                </div>
            </div>
            <div class="storage-info">
                <i class="fas fa-database"></i> Datos de pendientes guardados en tu navegador
            </div>
        </div>
    </section>

    <section id="finanzas" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-chart-line"></i>Finanzas Personales</h1>
            <p>Control de tus ingresos y egresos</p>
        </div>

        <div class="finance-category-selector">
            <button class="finance-category-btn active" data-finance-category="debts">Deudas</button>
            <button class="finance-category-btn" data-finance-category="gastos">Gastos Personales</button>
            <button class="finance-category-btn" data-finance-category="pagos">Fechas de Pago</button>
        </div>

        <!-- Apartado de Deudas -->
        <div class="container finance-section-content debts-content">
            <div class="summary-card">
                <h2>Total de Deudas</h2>
                <div class="total-amount" id="total-deudas-display">$0.00</div>
            </div>

            <div class="finance-controls">
                <label for="start-date-debts">Fecha de Inicio:</label>
                <input type="date" id="start-date-debts" class="form-control" style="width: auto; display: inline-block; margin-right: 10px;">
                <label for="end-date-debts">Fecha de Fin:</label>
                <input type="date" id="end-date-debts" class="form-control" style="width: auto; display: inline-block;">
                <button class="add-btn" id="generate-debt-dates-btn" style="width: auto; margin-left: 10px; padding: 10px 20px;">Generar Fechas</button>
            </div>

            <div class="loans-container" style="overflow-x: auto;">
                <table class="loans-table" id="debts-table">
                    <thead>
                        <tr id="debt-dates-row">
                            <th>Deuda</th>
                            <!-- Fechas de viernes se añadirán aquí dinámicamente -->
                        </tr>
                    </thead>
                    <tbody id="debts-list">
                        <!-- Filas de deudas se añadirán aquí dinámicamente -->
                    </tbody>
                    <tfoot id="debts-total-row">
                        <!-- Totales por fecha se añadirán aquí dinámicamente -->
                    </tfoot>
                </table>
            </div>

            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                <button class="add-btn" id="add-debt-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-plus-circle"></i>Añadir Deuda</button>
                <button class="add-btn" id="edit-debt-mode-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-edit"></i>Editar Deudas</button>
                <button class="add-btn delete-selected-btn" id="delete-selected-debts-btn" style="width: auto; padding: 10px 20px; background: linear-gradient(135deg, var(--error), #c0392b); display: none;"><i class="fas fa-trash-alt"></i>Eliminar Seleccionadas</button>
            </div>
        </div>

        <!-- Apartado de Gastos Personales -->
        <div class="container finance-section-content gastos-content" style="display: none;">
            <div class="summary-card">
                <h2>Total de Gastos Personales</h2>
                <div class="total-amount" id="total-gastos-display">$0.00</div>
            </div>

            <div class="loans-container" style="overflow-x: auto;">
                <table class="loans-table" id="gastos-table">
                    <thead>
                        <tr>
                            <th>Gasto</th>
                            <th>Cantidad</th>
                            <th>Fecha</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="gastos-list">
                        <!-- Filas de gastos se añadirán aquí dinámicamente -->
                    </tbody>
                </table>
            </div>

            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                <button class="add-btn" id="add-gasto-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-plus-circle"></i>Añadir Gasto</button>
                <button class="add-btn" id="edit-gasto-mode-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-edit"></i>Editar Gastos</button>
                <button class="add-btn delete-selected-btn" id="delete-selected-gastos-btn" style="width: auto; padding: 10px 20px; background: linear-gradient(135deg, var(--error), #c0392b); display: none;"><i class="fas fa-trash-alt"></i>Eliminar Seleccionadas</button>
            </div>
        </div>

        <!-- Apartado de Fechas de Pago -->
        <div class="container finance-section-content pagos-content" style="display: none;">
            <div class="summary-card">
                <h2>Fechas de Pago</h2>
                <p>Registro de fechas importantes para pagos</p>
            </div>

            <div class="loans-container" style="overflow-x: auto;">
                <table class="loans-table" id="fechas-pago-table">
                    <thead>
                        <tr>
                            <th>Deuda</th>
                            <th>Fecha de Pago</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="fechas-pago-list">
                        <!-- Datos de la imagen se añadirán aquí -->
                    </tbody>
                </table>
            </div>

            <div style="display: flex; justify-content: center; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                <button class="add-btn" id="add-pago-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-plus-circle"></i>Añadir Pago</button>
                <button class="add-btn" id="edit-pago-mode-btn" style="width: auto; padding: 10px 20px;"><i class="fas fa-edit"></i>Editar Pagos</button>
                <button class="add-btn delete-selected-btn" id="delete-selected-pagos-btn" style="width: auto; padding: 10px 20px; background: linear-gradient(135deg, var(--error), #c0392b); display: none;"><i class="fas fa-trash-alt"></i>Eliminar Seleccionadas</button>
            </div>
        </div>
    </section>

    <section id="transport-calculator" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-bus"></i>Calculadora de Gastos de Transporte Semanal</h1>
            <p>Calcula tus gastos de transporte para un período específico.</p>
        </div>
        <div class="transport-calculator-main-container mx-auto p-6 bg-white rounded-xl shadow-xl space-y-6">
            <h1 class="text-3xl font-extrabold text-center text-indigo-700 mb-6">Calculadora de Gastos de Transporte Semanal</h1>

            <!-- Sección de selección de rango de fechas -->
            <div class="flex flex-col sm:flex-row items-center justify-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6">
                <div class="flex flex-col items-center">
                    <label for="transportStartDate" class="text-lg font-medium text-gray-700 mb-2">Fecha de Inicio:</label>
                    <input type="date" id="transportStartDate" class="p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
                <div class="flex flex-col items-center">
                    <label for="transportEndDate" class="text-lg font-medium text-gray-700 mb-2">Fecha de Fin:</label>
                    <input type="date" id="transportEndDate" class="p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-lg">
                </div>
            </div>

            <!-- Tabla de horario semanal -->
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow-md">
                    <thead class="bg-indigo-600 text-white">
                        <tr>
                            <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider rounded-tl-lg">Día</th>
                            <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider">Fecha</th>
                            <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider">Visito a mi novia</th>
                            <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider">Día de Descanso</th>
                            <th class="py-3 px-4 text-left text-sm font-semibold uppercase tracking-wider rounded-tr-lg">Solo 2 Pasajes (20 MXN)</th>
                        </tr>
                    </thead>
                    <tbody id="transportScheduleBody" class="divide-y divide-gray-200">
                        <!-- Las filas se generarán dinámicamente aquí -->
                    </tbody>
                </table>
            </div>

            <!-- Botón de cálculo y resultado -->
            <div class="flex flex-col items-center mt-8 space-y-4">
                <button id="transportCalculateBtn" class="transport-button-primary text-xl px-8 py-4 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition duration-300 ease-in-out">
                    Calcular Gastos Totales
                </button>
                <p class="text-2xl font-bold text-gray-800">Total en el Periodo: <span id="transportTotalExpense" class="text-indigo-700">0.00</span> MXN</p>
            </div>
        </div>

        <!-- Caja de mensaje personalizada (Modal) para la calculadora de transporte -->
        <div id="transportMessageModal" class="transport-message-modal">
            <div class="transport-modal-content">
                <span class="transport-close-button" id="transportCloseModalBtn">&times;</span>
                <p id="transportModalMessage" class="text-lg text-gray-800"></p>
                <button id="transportModalOkBtn" class="mt-4 transport-button-primary">OK</button>
            </div>
        </div>
    </section>

    <section id="por-hacer-sam" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-heart"></i>Por Hacer con Sam</h1>
            <p>Planes y actividades para hacer juntos</p>
        </div>
        <div class="proximamente-container">
            <h2>Próximamente...</h2>
            <p>Esta sección está en desarrollo. ¡Vuelve pronto!</p>
        </div>
    </section>

    <section id="gustos-sam" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-gift"></i>Gustos de Sam</h1>
            <p>Recordatorios de cosas que le gustan a Sam</p>
        </div>
        <div class="proximamente-container">
            <h2>Próximamente...</h2>
            <p>Esta sección está en desarrollo. ¡Vuelve pronto!</p>
        </div>
    </section>

    <section id="compras" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-shopping-cart"></i>Compras Generales</h1>
            <p>Lista de compras y necesidades</p>
        </div>
        <div class="proximamente-container">
            <h2>Próximamente...</h2>
            <p>Esta sección está en desarrollo. ¡Vuelve pronto!</p>
        </div>
    </section>

    <section id="fechas" class="section">
        <div class="espacio-header">
            <h1><i class="fas fa-star"></i>Fechas Importantes</h1>
            <p>Aniversarios, cumpleaños y eventos especiales</p>
        </div>
        <div class="proximamente-container">
            <h2>Próximamente...</h2>
            <p>Esta sección está en desarrollo. ¡Vuelve pronto!</p>
        </div>
    </section>

    <!-- Modal para Préstamos -->
    <div class="modal" id="loan-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Agregar nuevo préstamo</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="loan-form">
                    <input type="hidden" id="loan-id">
                    <div class="form-group">
                        <label for="loan-amount">Cantidad ($)</label>
                        <input type="number" id="loan-amount" class="form-control" step="0.01" min="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="loan-concept">Concepto</label>
                        <input type="text" id="loan-concept" class="form-control" required>
                    </div>
                    <button type="submit" class="btn-submit">Guardar préstamo</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para CxC -->
    <div class="modal" id="cxc-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="cxc-modal-title">Agregar nueva cuenta por cobrar</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="cxc-form">
                    <div class="form-group">
                        <label for="cxc-week">Semana</label>
                        <input type="text" id="cxc-week" class="form-control" placeholder="Ej: 2025133" required>
                    </div>
                    <div class="form-group">
                        <label for="cxc-amount">Importe ($)</label>
                        <input type="number" id="cxc-amount" class="form-control" step="0.01" min="0.01" placeholder="Ej: 350.75" required>
                    </div>
                    <button type="submit" class="btn-submit">Guardar CxC</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Deuda -->
    <div class="modal" id="debt-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="debt-modal-title">Añadir Nueva Deuda</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="debt-form">
                    <input type="hidden" id="debt-id">
                    <div class="form-group">
                        <label for="debt-name">Nombre de la Deuda</label>
                        <input type="text" id="debt-name" class="form-control" required>
                    </div>
                    <div id="debt-amounts-group" class="form-group">
                        <!-- Campos de cantidad para cada fecha se añadirán aquí dinámicamente -->
                    </div>
                    <button type="submit" class="btn-submit">Guardar Deuda</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Gasto Personal -->
    <div class="modal" id="gasto-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="gasto-modal-title">Añadir Nuevo Gasto</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="gasto-form">
                    <input type="hidden" id="gasto-id">
                    <div class="form-group">
                        <label for="gasto-name-select">Nombre del Gasto</label>
                        <select id="gasto-name-select" class="form-control" required>
                            <option value="">Selecciona un gasto</option>
                            <option value="CxC">CxC</option>
                            <option value="Saldo">Saldo</option>
                            <option value="Dinero Transporte">Dinero Transporte</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="gasto-amount">Cantidad ($)</label>
                        <input type="number" id="gasto-amount" class="form-control" step="0.01" min="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="gasto-date">Fecha</label>
                        <input type="date" id="gasto-date" class="form-control" required>
                    </div>
                    <button type="submit" class="btn-submit">Guardar Gasto</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Fecha de Pago -->
    <div class="modal" id="pago-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="pago-modal-title">Añadir Nueva Fecha de Pago</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="pago-form">
                    <input type="hidden" id="pago-id">
                    <div class="form-group">
                        <label for="pago-debt-name">Deuda</label>
                        <input type="text" id="pago-debt-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="pago-date-input">Fecha de Pago</label>
                        <input type="text" id="pago-date-input" class="form-control" placeholder="Ej: 16 de cada mes / 22-jun-25" required>
                    </div>
                    <button type="submit" class="btn-submit">Guardar Pago</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal para Añadir/Editar Pendiente -->
    <div class="modal" id="pending-modal">
        <div class="modal-content">
            <div class="modal-header">
                <!-- Se muestra la categoría del pendiente aquí -->
                <h3 id="pending-modal-title">Agregar Nuevo Pendiente (<span id="pending-modal-category-display"></span>)</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="pending-form">
                    <input type="hidden" id="pending-id">
                    <input type="hidden" id="pending-category-input"> <!-- Hidden input to store current category -->
                    <div class="form-group">
                        <label for="pending-text">Descripción del Pendiente</label>
                        <textarea id="pending-text" class="form-control" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <div class="pending-radio-group">
                            <label>
                                <input type="radio" name="pending-date-option" value="specific" checked> Fecha Específica
                            </label>
                            <label>
                                <input type="radio" name="pending-date-option" value="indefinite"> Indefinida
                            </label>
                        </div>
                        <input type="date" id="pending-date-input" class="form-control">
                    </div>
                    <button type="submit" class="btn-submit">Guardar Pendiente</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmación para Eliminar (General) -->
    <div class="modal" id="confirm-delete-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Confirmar Eliminación</h3>
                <button class="close-modal" id="close-confirm-delete-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-delete-message">¿Estás seguro de que deseas eliminar los elementos seleccionados?</p>
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                    <button class="btn-submit" id="cancel-delete-btn" style="background: #ccc; color: #333;">Cancelar</button>
                    <button class="btn-submit" id="confirm-delete-btn" style="background: var(--error);">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notificación -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Operación realizada con éxito</span>
    </div>

    <footer>
        <p>Todos los derechos reservados a Mario Vázquez © 2025</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.getElementById('menu-toggle');
            const navLinks = document.getElementById('nav-links');
            const navItems = document.querySelectorAll('.nav-link');
            const moreMenuBtn = document.getElementById('more-menu-btn');
            const moreLinksModal = document.getElementById('more-links-modal');
            const mobileMenuModal = document.getElementById('mobile-menu-modal');
            const closeMobileMenu = document.getElementById('close-mobile-menu');
            const mobileNavLinks = document.querySelectorAll('#mobile-nav-links .nav-link');

            // --- Lógica de Navegación ---
            
            // Activar sección inicial
            activateSection('home');
            
            // Toggle del menú móvil
            menuToggle.addEventListener('click', () => {
                mobileMenuModal.classList.add('active');
            });
            
            // Cerrar menú móvil
            closeMobileMenu.addEventListener('click', () => {
                mobileMenuModal.classList.remove('active');
            });
            
            // Clic en cualquier link de navegación en el modal móvil
            mobileNavLinks.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-target');
                    activateSection(target);
                    
                    // Actualizar estado activo de los links
                    updateActiveLink(this);
                    
                    // Cerrar modal móvil
                    mobileMenuModal.classList.remove('active');
                });
            });

            // Clic en cualquier link de navegación en escritorio
            navItems.forEach(item => {
                // El botón "Más" no navega, solo abre el menú
                if (item.id === 'more-menu-btn') return;

                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = this.getAttribute('data-target');
                    activateSection(target);
                    
                    // Actualizar estado activo de los links
                    updateActiveLink(this);
                    
                    // Cerrar menús
                    if (moreLinksModal.classList.contains('active')) {
                        moreLinksModal.classList.remove('active');
                        moreMenuBtn.classList.remove('open');
                    }
                });
            });

            // Abrir/Cerrar menú "Más"
            if (moreMenuBtn) {
                moreMenuBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    moreLinksModal.classList.toggle('active');
                    this.classList.toggle('open');
                });
            }

            // Cerrar menú "Más" si se hace clic fuera
            window.addEventListener('click', function(e) {
                if (moreMenuBtn && !moreMenuBtn.parentElement.contains(e.target)) {
                    moreLinksModal.classList.remove('active');
                    moreMenuBtn.classList.remove('open');
                }
            });

            // Botones de bienvenida que también navegan
            document.querySelectorAll('.welcome-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const target = this.getAttribute('data-target');
                    activateSection(target);
                    const linkToActivate = document.querySelector(`.nav-link[data-target="${target}"]`);
                    updateActiveLink(linkToActivate);
                });
            });
            
            // --- Funciones de Ayuda para Navegación ---
            function activateSection(sectionId) {
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
                window.scrollTo({ top: 0, behavior: 'smooth' });

                // Lógica de bloqueo para la sección de Préstamos Sam
                if (sectionId === 'loans') {
                    checkLoansLockStatus();
                }
            }

            function updateActiveLink(activeLink) {
                // Quitar 'active' de todos los links (escritorio y móvil)
                document.querySelectorAll('.nav-link').forEach(i => i.classList.remove('active'));
                
                if (activeLink) {
                    const target = activeLink.dataset.target;
                    
                    // Activar el link correspondiente en el menú de escritorio y móvil
                    document.querySelectorAll(`.nav-link[data-target="${target}"]`).forEach(link => {
                        link.classList.add('active');
                    });
                    
                    // Si el link activado está dentro del modal "Más", también activar el botón "Más"
                    if (activeLink.closest('.more-links-modal')) {
                        if(moreMenuBtn) moreMenuBtn.classList.add('active');
                    }
                }
            }

            // --- Lógica de Horarios ---
            const scheduleBtns = document.querySelectorAll('.schedule-btn');
            const scheduleContainers = document.querySelectorAll('.schedule-container');
            
            scheduleBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const scheduleType = this.getAttribute('data-schedule');
                    scheduleBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    scheduleContainers.forEach(container => {
                        container.style.display = 'none';
                        if(container.classList.contains(`${scheduleType}-schedule`)) {
                            container.style.display = 'block';
                        }
                    });
                });
            });
            
            // --- Lógica para Préstamos ---
            const loanForm = document.getElementById('loan-form');
            const loansList = document.getElementById('loans-list');
            const totalAmountElement = document.querySelector('#loans .total-amount'); // Corregido selector
            const openModalButton = document.getElementById('open-modal');
            const modal = document.getElementById('loan-modal');
            const closeModalButton = modal.querySelector('.close-modal'); // Selector específico para este modal
            const modalTitle = document.getElementById('modal-title');
            const loanIdInput = document.getElementById('loan-id');
            const loanAmountInput = document.getElementById('loan-amount');
            const loanConceptInput = document.getElementById('loan-concept');
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');

            // Elementos de bloqueo de préstamos
            const loansSectionContent = document.getElementById('loans-section-content');
            const loansLockOverlay = document.getElementById('loans-lock-overlay');
            const loansContentWrapper = document.getElementById('loans-content-wrapper');
            const pinInput = document.getElementById('pin-input');
            const unlockLoansBtn = document.getElementById('unlock-loans-btn');
            const CORRECT_PIN = "2003"; // PIN para desbloquear

            function checkLoansLockStatus() {
                const isUnlocked = localStorage.getItem('loansUnlocked') === 'true';
                if (isUnlocked) {
                    loansLockOverlay.style.display = 'none';
                    loansContentWrapper.style.display = 'block';
                } else {
                    loansLockOverlay.style.display = 'flex'; // Usar flex para centrar contenido
                    loansContentWrapper.style.display = 'none';
                    pinInput.value = ''; // Limpiar el input de PIN
                }
            }

            unlockLoansBtn.addEventListener('click', () => {
                if (pinInput.value === CORRECT_PIN) {
                    localStorage.setItem('loansUnlocked', 'true');
                    checkLoansLockStatus();
                    showNotification('Sección "Préstamos Sam" desbloqueada', 'success');
                } else {
                    showNotification('PIN incorrecto. Intenta de nuevo.', 'error');
                    pinInput.value = ''; // Limpiar el input
                }
            });
            
            let loans = [];
            let currentEditId = null;
            
            function loadLoans() {
                try {
                    const savedLoans = localStorage.getItem('prestamosSam');
                    loans = savedLoans ? JSON.parse(savedLoans) : [];
                    console.log("Préstamos cargados:", loans); // Debug log
                } catch (e) {
                    console.error("Error al cargar préstamos de localStorage", e);
                    loans = [];
                }
            }
            
            function saveLoans() {
                try {
                    localStorage.setItem('prestamosSam', JSON.stringify(loans));
                    console.log("Préstamos guardados:", loans); // Debug log
                } catch (e) {
                    console.error("Error al guardar préstamos en localStorage", e);
                }
            }
            
            function calculateTotal() {
                const total = loans.reduce((sum, loan) => sum + parseFloat(loan.amount), 0);
                totalAmountElement.textContent = `$${total.toFixed(2)}`;
            }
            
            function renderLoans() {
                loansList.innerHTML = '';
                if (loans.length === 0) {
                    loansList.innerHTML = `<tr><td colspan="4" style="text-align: center; padding: 30px;">No hay préstamos registrados</td></tr>`;
                    calculateTotal();
                    return;
                }
                loans.forEach(loan => {
                    const row = document.createElement('tr');
                    const loanDate = new Date(loan.date);
                    const formattedDate = loanDate.toLocaleString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric', hour: '2-digit', minute: '2-digit' });
                    row.innerHTML = `
                        <td class="loan-amount">$${parseFloat(loan.amount).toFixed(2)}</td>
                        <td class="loan-concept">${loan.concept}</td>
                        <td class="loan-date">${formattedDate}</td>
                        <td class="loan-actions">
                            <button class="action-btn edit-btn" data-id="${loan.id}"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn" data-id="${loan.id}"><i class="fas fa-trash-alt"></i></button>
                        </td>`;
                    loansList.appendChild(row);
                });
                calculateTotal();
                addLoanRowEventListeners(); // Re-add event listeners after rendering
            }
            
            function openLoanModal(loanId = null) {
                currentEditId = loanId;
                if (loanId) {
                    modalTitle.textContent = 'Editar préstamo';
                    const loan = loans.find(l => l.id === loanId);
                    if (loan) {
                        loanIdInput.value = loan.id;
                        loanAmountInput.value = loan.amount;
                        loanConceptInput.value = loan.concept;
                    }
                } else {
                    modalTitle.textContent = 'Agregar nuevo préstamo';
                    loanForm.reset();
                    loanIdInput.value = '';
                }
                modal.classList.add('active');
            }
            
            function closeLoanModal() {
                modal.classList.remove('active');
                currentEditId = null;
            }
            
            function handleLoanFormSubmit(e) {
                e.preventDefault();
                const amount = parseFloat(loanAmountInput.value);
                const concept = loanConceptInput.value.trim();
                if (isNaN(amount) || amount <= 0 || concept === '') {
                    showNotification('Por favor completa todos los campos correctamente', 'error');
                    return;
                }
                if (currentEditId) {
                    const loanIndex = loans.findIndex(l => l.id === currentEditId);
                    if (loanIndex !== -1) {
                        loans[loanIndex].amount = amount;
                        loans[loanIndex].concept = concept;
                        showNotification('Préstamo actualizado con éxito', 'success');
                    }
                } else {
                    const newLoan = { id: Date.now(), amount: amount, concept: concept, date: new Date().toISOString() };
                    loans.push(newLoan);
                    showNotification('Préstamo agregado con éxito', 'success');
                }
                saveLoans();
                renderLoans();
                closeLoanModal();
            }

            function addLoanRowEventListeners() {
                loansList.querySelectorAll('.edit-btn').forEach(button => {
                    button.onclick = () => openLoanModal(parseInt(button.dataset.id));
                });
                loansList.querySelectorAll('.delete-btn').forEach(button => {
                    button.onclick = () => showConfirmDeleteModal(parseInt(button.dataset.id), 'loan');
                });
            }
            
            function showNotification(message, type = 'success') {
                notificationText.textContent = message;
                notification.className = `notification ${type} show`;
                const icon = notification.querySelector('i');
                if (type === 'success') icon.className = 'fas fa-check-circle';
                if (type === 'error') icon.className = 'fas fa-times-circle';
                if (type === 'info') icon.className = 'fas fa-info-circle';
                setTimeout(() => notification.classList.remove('show'), 3000);
            }
            
            // Carga inicial y listeners de préstamos
            loadLoans();
            renderLoans();
            openModalButton.addEventListener('click', () => openLoanModal());
            closeModalButton.addEventListener('click', () => closeLoanModal());
            loanForm.addEventListener('submit', handleLoanFormSubmit);
            modal.addEventListener('click', (e) => { if (e.target === modal) closeLoanModal(); });
            
            // --- Lógica para CxC ---
            const cxcForm = document.getElementById('cxc-form');
            const cxcList = document.getElementById('cxc-list');
            const totalCxcAmountElement = document.getElementById('total-cxc-display'); // Changed to specific ID
            const addCxcButton = document.getElementById('add-cxc-btn');
            const cxcModal = document.getElementById('cxc-modal');
            const closeCxcModalButton = cxcModal.querySelector('.close-modal');
            const cxcModalTitle = document.getElementById('cxc-modal-title');
            const cxcWeekInput = document.getElementById('cxc-week');
            const cxcAmountInput = document.getElementById('cxc-amount');
            
            // Initial CxC data (from the original HTML, converted to JS array)
            const initialCxCsData = [
                { id: 1, week: "2025129", amount: 115.50 },
                { id: 2, week: "2025130", amount: 290.00 },
                { id: 3, week: "2025131", amount: 1068.50 },
                { id: 4, week: "2025132", amount: 583.97 }
            ];

            let cxcs = []; 
            
            function loadCxCs() {
                try {
                    const savedCxCs = localStorage.getItem('cuentasPorCobrar');
                    cxcs = savedCxCs ? JSON.parse(savedCxCs) : initialCxCsData; // Use initialCxCsData if nothing saved
                    console.log("CxC cargadas:", cxcs); // Debug log
                } catch (e) {
                    console.error("Error al cargar CxC de localStorage", e);
                    cxcs = initialCxCsData; // Fallback
                }
            }

            function saveCxCs() {
                try {
                    localStorage.setItem('cuentasPorCobrar', JSON.stringify(cxcs));
                    console.log("CxC guardadas:", cxcs); // Debug log
                } catch (e) {
                    console.error("Error al guardar CxC en localStorage", e);
                }
            }

            function calculateTotalCxc() {
                const total = cxcs.reduce((sum, cxc) => sum + parseFloat(cxc.amount), 0);
                totalCxcAmountElement.textContent = `$${total.toFixed(2)}`;
            }

            function renderCxCs() {
                cxcList.innerHTML = '';
                if (cxcs.length === 0) {
                    cxcList.innerHTML = `<tr><td colspan="3" style="text-align: center; padding: 30px;">No hay cuentas por cobrar registradas</td></tr>`;
                    calculateTotalCxc();
                    return;
                }
                cxcs.forEach(cxc => {
                    const row = document.createElement('tr');
                    row.dataset.id = cxc.id;
                    row.dataset.week = cxc.week;
                    row.dataset.amount = cxc.amount;
                    row.innerHTML = `
                        <td>${cxc.week}</td>
                        <td class="loan-amount">$${parseFloat(cxc.amount).toFixed(2)}</td>
                        <td class="loan-actions">
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash-alt"></i></button>
                        </td>
                    `;
                    cxcList.appendChild(row);
                    addCxcRowEventListeners(row);
                });
                calculateTotalCxc();
            }
            
            // Abrir modal para añadir CxC
            addCxcButton.addEventListener('click', () => {
                cxcForm.reset();
                cxcModalTitle.textContent = 'Agregar nueva cuenta por cobrar';
                cxcModal.classList.add('active');
            });
            
            // Cerrar modal CxC
            closeCxcModalButton.addEventListener('click', () => {
                cxcModal.classList.remove('active');
            });
            
            // Enviar formulario CxC
            cxcForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const week = cxcWeekInput.value.trim();
                const amount = parseFloat(cxcAmountInput.value);
                
                if (week && !isNaN(amount) && amount > 0) {
                    const newCxc = {
                        id: Date.now(),
                        week: week,
                        amount: amount
                    };
                    
                    cxcs.push(newCxc);
                    saveCxCs();
                    renderCxCs(); // Re-render all CxCs to ensure event listeners are correctly attached
                    
                    cxcModal.classList.remove('active');
                    showNotification('Cuenta por cobrar añadida con éxito', 'success');
                } else {
                    showNotification('Por favor ingresa datos válidos', 'error');
                }
            });
            
            function addCxcRowEventListeners(row) {
                // Botón editar
                row.querySelector('.edit-btn').addEventListener('click', function() {
                    const weekCell = row.cells[0];
                    const amountCell = row.cells[1];
                    
                    // Guardar valores originales
                    const originalWeek = weekCell.textContent;
                    const originalAmount = parseFloat(amountCell.textContent.replace('$', ''));

                    // Convertir a campos editables
                    weekCell.innerHTML = `<input type="text" class="form-control" value="${originalWeek}">`;
                    amountCell.innerHTML = `<input type="number" class="form-control" value="${originalAmount}" step="0.01">`;
                    
                    // Cambiar botones
                    const actionsCell = row.cells[2];
                    actionsCell.innerHTML = `
                        <button class="action-btn save-btn"><i class="fas fa-save"></i></button>
                        <button class="action-btn cancel-btn"><i class="fas fa-times"></i></button>
                    `;
                    
                    // Event listener para guardar
                    actionsCell.querySelector('.save-btn').addEventListener('click', function() {
                        const newWeek = row.querySelector('td:first-child input').value.trim();
                        const newAmount = parseFloat(row.querySelector('td:nth-child(2) input').value);
                        
                        if (newWeek && !isNaN(newAmount) && newAmount > 0) {
                            // Actualizar datos en el array
                            const rowId = parseInt(row.dataset.id);
                            const cxcIndex = cxcs.findIndex(c => c.id === rowId);
                            if (cxcIndex !== -1) {
                                cxcs[cxcIndex].week = newWeek;
                                cxcs[cxcIndex].amount = newAmount;
                            }
                            saveCxCs();
                            renderCxCs(); // Re-render all CxCs
                            showNotification('Cuenta actualizada con éxito', 'success');
                        } else {
                            showNotification('Datos inválidos', 'error');
                        }
                    });
                    
                    // Event listener para cancelar
                    actionsCell.querySelector('.cancel-btn').addEventListener('click', function() {
                        // Restaurar valores originales
                        weekCell.textContent = originalWeek;
                        amountCell.innerHTML = `$${originalAmount.toFixed(2)}`;
                        
                        // Restaurar botones
                        actionsCell.innerHTML = `
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash-alt"></i></button>
                        `;
                        
                        // Volver a agregar event listeners
                        addCxcRowEventListeners(row);
                    });
                });
                
                // Botón eliminar
                row.querySelector('.delete-btn').addEventListener('click', function() {
                    const rowId = parseInt(row.dataset.id);
                    showConfirmDeleteModal(rowId, 'cxc');
                });
            }

            // Carga inicial de CxC
            loadCxCs();
            renderCxCs();

            // --- Lógica para Finanzas (Deudas, Gastos Personales, Fechas de Pago) ---

            // Referencias a elementos del DOM para Deudas
            const startDateDebtsInput = document.getElementById('start-date-debts');
            const endDateDebtsInput = document.getElementById('end-date-debts');
            const generateDebtDatesBtn = document.getElementById('generate-debt-dates-btn');
            const debtDatesRow = document.getElementById('debt-dates-row');
            const debtsList = document.getElementById('debts-list');
            const debtsTotalRow = document.getElementById('debts-total-row');
            const totalDeudasDisplay = document.getElementById('total-deudas-display');
            const addDebtBtn = document.getElementById('add-debt-btn');
            const editDebtModeBtn = document.getElementById('edit-debt-mode-btn');
            const deleteSelectedDebtsBtn = document.getElementById('delete-selected-debts-btn');
            const debtModal = document.getElementById('debt-modal');
            const debtModalCloseBtn = debtModal.querySelector('.close-modal');
            const debtModalTitle = document.getElementById('debt-modal-title');
            const debtForm = document.getElementById('debt-form');
            const debtIdInput = document.getElementById('debt-id');
            const debtNameInput = document.getElementById('debt-name');
            const debtAmountsGroup = document.getElementById('debt-amounts-group');

            // Referencias a elementos del DOM para Gastos Personales
            const gastosList = document.getElementById('gastos-list');
            const totalGastosDisplay = document.getElementById('total-gastos-display');
            const addGastoBtn = document.getElementById('add-gasto-btn');
            const editGastoModeBtn = document.getElementById('edit-gasto-mode-btn');
            const deleteSelectedGastosBtn = document.getElementById('delete-selected-gastos-btn');
            const gastoModal = document.getElementById('gasto-modal');
            const gastoModalCloseBtn = gastoModal.querySelector('.close-modal');
            const gastoModalTitle = document.getElementById('gasto-modal-title');
            const gastoForm = document.getElementById('gasto-form');
            const gastoIdInput = document.getElementById('gasto-id');
            const gastoNameSelect = document.getElementById('gasto-name-select');
            const gastoAmountInput = document.getElementById('gasto-amount');
            const gastoDateInput = document.getElementById('gasto-date');

            // Referencias a elementos del DOM para Fechas de Pago
            const fechasPagoList = document.getElementById('fechas-pago-list');
            const addPagoBtn = document.getElementById('add-pago-btn');
            const editPagoModeBtn = document.getElementById('edit-pago-mode-btn');
            const deleteSelectedPagosBtn = document.getElementById('delete-selected-pagos-btn');
            const pagoModal = document.getElementById('pago-modal');
            const pagoModalCloseBtn = pagoModal.querySelector('.close-modal');
            const pagoModalTitle = document.getElementById('pago-modal-title');
            const pagoForm = document.getElementById('pago-form');
            const pagoIdInput = document.getElementById('pago-id');
            const pagoDebtNameInput = document.getElementById('pago-debt-name');
            const pagoDateInput = document.getElementById('pago-date-input');

            // Referencias para el modal de confirmación de eliminación
            const confirmDeleteModal = document.getElementById('confirm-delete-modal');
            const closeConfirmDeleteModalBtn = document.getElementById('close-confirm-delete-modal');
            const confirmDeleteMessage = document.getElementById('confirm-delete-message');
            const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
            const confirmDeleteBtn = document.getElementById('confirm-delete-btn');

            let debts = [];
            let gastos = [];
            let pagos = [];
            let currentDebtDates = [];
            let currentDeleteTarget = null; // 'loan', 'cxc', 'debt', 'gasto', 'pago', 'pending'
            let currentDeleteId = null; // ID for single item deletion
            let isEditModeDebts = false;
            let isEditModeGastos = false;
            let isEditModePagos = false;


            // Datos iniciales de deudas (nombres de la imagen)
            const initialDebtNames = [
                "DIDI PRESTAMO", "MERCADO PAGO", "MELI +", "MAX", "PRIME VIDEO",
                "TALA", "BAUBAP", "RIFA VERO", "RIFA ANDREA", "KUESKI"
            ];

            // Datos iniciales de fechas de pago (de la imagen)
            const initialPagos = [
                { id: 1, debtName: "DIDI PRESTAMO", paymentDate: "CADA QUINCENA" },
                { id: 2, debtName: "MERCADO PAGO", paymentDate: "16 DE CADA MES" },
                { id: 3, debtName: "MELI +", paymentDate: "22 JUNIO 2025" },
                { id: 4, debtName: "MAX", paymentDate: "05-jul-25" },
                { id: 5, debtName: "PRIME VIDEO", paymentDate: "-----" },
                { id: 6, debtName: "TALA", paymentDate: "12-jul-25" },
                { id: 7, debtName: "BAUBAP", paymentDate: "30-jun-25" },
                { id: 8, debtName: "RIFA VERO", paymentDate: "CADA QUINCENA" },
                { id: 9, debtName: "RIFA ANDREA", paymentDate: "-----" },
                { id: 10, debtName: "KUESKI", paymentDate: "04-jul-25" }
            ];

            // --- Funciones Generales de Utilidad ---

            function showConfirmDeleteModal(id, type) {
                currentDeleteTarget = type;
                currentDeleteId = id;
                let message = '¿Estás seguro de que deseas eliminar ';
                if (id) {
                    message += 'este elemento';
                } else {
                    message += 'los elementos seleccionados';
                }

                if (type === 'loan') message += ' de préstamos';
                else if (type === 'cxc') message += ' de cuentas por cobrar';
                else if (type === 'debt') message += ' de deudas';
                else if (type === 'gasto') message += ' de gastos personales';
                else if (type === 'pago') message += ' de fechas de pago';
                else if (type === 'pending') message += ' este pendiente';

                confirmDeleteMessage.textContent = message + '?';
                confirmDeleteModal.classList.add('active');
            }

            function closeConfirmDeleteModal() {
                confirmDeleteModal.classList.remove('active');
                currentDeleteTarget = null;
                currentDeleteId = null;
            }

            confirmDeleteBtn.addEventListener('click', () => {
                if (currentDeleteTarget === 'loan') {
                    loans = loans.filter(loan => loan.id !== currentDeleteId);
                    saveLoans();
                    renderLoans();
                    showNotification('Préstamo eliminado con éxito', 'success');
                } else if (currentDeleteTarget === 'cxc') {
                    cxcs = cxcs.filter(cxc => cxc.id !== currentDeleteId);
                    saveCxCs();
                    renderCxCs();
                    showNotification('Cuenta eliminada con éxito', 'success');
                } else if (currentDeleteTarget === 'debt') {
                    deleteSelectedDebts();
                } else if (currentDeleteTarget === 'gasto') {
                     if (currentDeleteId) { // Single delete
                        gastos = gastos.filter(gasto => gasto.id !== currentDeleteId);
                    } else { // Multiple delete
                        deleteSelectedGastos();
                    }
                    saveGastos();
                    renderGastos();
                    showNotification('Gasto(s) eliminado(s) con éxito', 'success');
                } else if (currentDeleteTarget === 'pago') {
                    if (currentDeleteId) { // Single delete
                        pagos = pagos.filter(pago => pago.id !== currentDeleteId);
                    } else { // Multiple delete
                        deleteSelectedPagos();
                    }
                    savePagos();
                    renderPagos();
                    showNotification('Fecha(s) de pago eliminada(s) con éxito', 'success');
                } else if (currentDeleteTarget === 'pending') {
                    deletePendingTask(currentDeleteId);
                }
                closeConfirmDeleteModal();
            });

            cancelDeleteBtn.addEventListener('click', () => {
                closeConfirmDeleteModal();
            });

            closeConfirmDeleteModalBtn.addEventListener('click', () => {
                closeConfirmDeleteModal();
            });

            confirmDeleteModal.addEventListener('click', (e) => {
                if (e.target === confirmDeleteModal) {
                    closeConfirmDeleteModal();
                }
            });


            // --- Lógica para Deudas ---

            function getFridaysInPeriod(startDate, endDate) {
                const dates = [];
                let currentDate = new Date(startDate);
                // Ajustar para que la fecha de inicio no se vea afectada por la zona horaria
                currentDate.setUTCHours(0, 0, 0, 0);
                
                // Ir al primer viernes en o después de la fecha de inicio
                currentDate.setDate(currentDate.getDate() + (5 - currentDate.getDay() + 7) % 7);

                while (currentDate <= endDate) {
                    dates.push(new Date(currentDate));
                    currentDate.setDate(currentDate.getDate() + 7); // Añadir 7 días para el próximo viernes
                }
                return dates;
            }

            function formatToYYYYMMDD(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }

            function formatToDDMonYY(date) {
                const options = { day: '2-digit', month: 'short', year: '2-digit' };
                return date.toLocaleDateString('es-ES', options).replace(/\./g, '').replace(' ', '-');
            }

            function loadDebts() {
                try {
                    const savedDebts = localStorage.getItem('deudas');
                    if (savedDebts) {
                        debts = JSON.parse(savedDebts);
                    } else {
                        // Si no hay datos guardados, inicializar con los nombres por defecto
                        debts = initialDebtNames.map((name, index) => ({
                            id: Date.now() + index, // Usar un ID numérico único
                            name: name,
                            amounts: {} // Los montos estarán indexados por fecha (YYYY-MM-DD)
                        }));
                    }
                    console.log("Deudas cargadas:", debts);
                } catch (e) {
                    console.error("Error al cargar deudas de localStorage", e);
                    debts = [];
                }
            }

            function saveDebts() {
                try {
                    localStorage.setItem('deudas', JSON.stringify(debts));
                    console.log("Deudas guardadas:", debts);
                } catch (e) {
                    console.error("Error al guardar deudas en localStorage", e);
                }
            }

            function calculateTotalDebts() {
                const totalByDate = {};
                let overallTotal = 0;

                // Inicializar totales por fecha
                currentDebtDates.forEach(date => {
                    const dateKey = formatToYYYYMMDD(date);
                    totalByDate[dateKey] = 0;
                });

                // Sumar las deudas
                debts.forEach(debt => {
                    Object.keys(debt.amounts).forEach(dateKey => {
                        if (totalByDate.hasOwnProperty(dateKey)) {
                            const amount = parseFloat(debt.amounts[dateKey]) || 0;
                            totalByDate[dateKey] += amount;
                        }
                    });
                });

                // Limpiar el contenido existente del pie de la tabla
                debtsTotalRow.innerHTML = ''; 
                
                const totalRow = document.createElement('tr');
                let totalRowHTML = `<td><strong>Total</strong></td>`;
                
                currentDebtDates.forEach(date => {
                    const dateKey = formatToYYYYMMDD(date);
                    const totalForDate = totalByDate[dateKey] || 0;
                    totalRowHTML += `<td><strong>$${totalForDate.toFixed(2)}</strong></td>`;
                    overallTotal += totalForDate;
                });
                
                if (isEditModeDebts) {
                    totalRowHTML += '<td></td>'; // Celda vacía para la columna de eliminar
                }
                
                totalRow.innerHTML = totalRowHTML;
                debtsTotalRow.appendChild(totalRow);

                // Actualizar el total general
                totalDeudasDisplay.textContent = `$${overallTotal.toFixed(2)}`;
            }

            function renderDebts() {
                // Renderizar encabezados de fecha
                debtDatesRow.innerHTML = '<th>Deuda</th>';
                currentDebtDates.forEach(date => {
                    debtDatesRow.innerHTML += `<th>${formatToDDMonYY(date)}</th>`;
                });
                if (isEditModeDebts) {
                    debtDatesRow.innerHTML += '<th>Eliminar</th>';
                }

                // Renderizar filas de deudas
                debtsList.innerHTML = '';
                if (debts.length === 0) {
                    const colspan = currentDebtDates.length + (isEditModeDebts ? 2 : 1);
                    debtsList.innerHTML = `<tr><td colspan="${colspan}" style="text-align: center; padding: 30px;">No hay deudas registradas</td></tr>`;
                    calculateTotalDebts();
                    return;
                }

                debts.forEach(debt => {
                    const row = document.createElement('tr');
                    row.dataset.id = debt.id;
                    let rowContent = `<td>${debt.name}</td>`;
                    currentDebtDates.forEach(date => {
                        const dateKey = formatToYYYYMMDD(date);
                        const amount = debt.amounts[dateKey] || 0;
                        rowContent += `<td><input type="number" class="form-control amount-input" data-date="${dateKey}" value="${amount.toFixed(2)}" step="0.01" ${!isEditModeDebts ? 'disabled' : ''}></td>`;
                    });
                    if (isEditModeDebts) {
                        rowContent += `<td><input type="checkbox" class="debt-checkbox" data-id="${debt.id}"></td>`;
                    }
                    row.innerHTML = rowContent;
                    debtsList.appendChild(row);
                });
                
                addDebtInputListeners();
                calculateTotalDebts();
            }
            
            function addDebtInputListeners() {
                debtsList.querySelectorAll('.amount-input').forEach(input => {
                    input.addEventListener('input', function() {
                        const debtId = parseInt(this.closest('tr').dataset.id);
                        const dateKey = this.dataset.date;
                        const newAmount = parseFloat(this.value) || 0;
                        
                        const debtIndex = debts.findIndex(d => d.id === debtId);
                        if (debtIndex !== -1) {
                            debts[debtIndex].amounts[dateKey] = newAmount;
                        }
                        calculateTotalDebts();
                    });
                });
            }

            function openDebtModal(debtId = null) {
                currentEditId = debtId;
                debtAmountsGroup.innerHTML = '';

                if (debtId) {
                    debtModalTitle.textContent = 'Editar Deuda';
                    const debt = debts.find(d => d.id === debtId);
                    if (debt) {
                        debtIdInput.value = debt.id;
                        debtNameInput.value = debt.name;
                        // No es necesario poblar montos aquí, ya que la edición se hace en línea
                    }
                } else {
                    debtModalTitle.textContent = 'Añadir Nueva Deuda';
                    debtForm.reset();
                    debtIdInput.value = '';
                }
                debtModal.classList.add('active');
            }

            function closeDebtModal() {
                debtModal.classList.remove('active');
                currentEditId = null;
            }

            function handleDebtFormSubmit(e) {
                e.preventDefault();
                const debtName = debtNameInput.value.trim();
                if (debtName === '') {
                    showNotification('El nombre de la deuda no puede estar vacío', 'error');
                    return;
                }

                if (currentEditId) {
                    // La edición de nombre se maneja aquí
                    const debtIndex = debts.findIndex(d => d.id === currentEditId);
                    if (debtIndex !== -1) {
                        debts[debtIndex].name = debtName;
                        showNotification('Deuda actualizada con éxito', 'success');
                    }
                } else {
                    // Añadir nueva deuda
                    const newDebt = { id: Date.now(), name: debtName, amounts: {} };
                    debts.push(newDebt);
                    showNotification('Deuda añadida con éxito', 'success');
                }
                saveDebts();
                renderDebts();
                closeDebtModal();
            }

            function toggleEditModeDebts() {
                isEditModeDebts = !isEditModeDebts;
                if (isEditModeDebts) {
                    editDebtModeBtn.innerHTML = '<i class="fas fa-save"></i> Guardar Cambios';
                    editDebtModeBtn.classList.add('active');
                    addDebtBtn.style.display = 'none';
                    deleteSelectedDebtsBtn.style.display = 'inline-flex';
                } else {
                    saveDebts(); // Guardar todos los cambios al salir del modo edición
                    editDebtModeBtn.innerHTML = '<i class="fas fa-edit"></i> Editar Deudas';
                    editDebtModeBtn.classList.remove('active');
                    addDebtBtn.style.display = 'inline-flex';
                    deleteSelectedDebtsBtn.style.display = 'none';
                    showNotification('Cambios en deudas guardados', 'success');
                }
                renderDebts();
            }

            function deleteSelectedDebts() {
                const selectedDebtIds = Array.from(document.querySelectorAll('.debt-checkbox:checked'))
                                            .map(checkbox => parseInt(checkbox.dataset.id));
                if (selectedDebtIds.length > 0) {
                    debts = debts.filter(debt => !selectedDebtIds.includes(debt.id));
                    saveDebts();
                    renderDebts();
                    showNotification('Deudas seleccionadas eliminadas', 'success');
                } else {
                    showNotification('Ninguna deuda seleccionada para eliminar', 'info');
                }
            }

            // Event Listeners para Deudas
            generateDebtDatesBtn.addEventListener('click', () => {
                const startDateStr = startDateDebtsInput.value;
                const endDateStr = endDateDebtsInput.value;

                if (!startDateStr || !endDateStr) {
                    showNotification('Por favor, selecciona un rango de fechas válido.', 'error');
                    return;
                }

                const startDate = new Date(startDateStr);
                const endDate = new Date(endDateStr);

                if (isNaN(startDate.getTime()) || isNaN(endDate.getTime()) || startDate > endDate) {
                    showNotification('Por favor, selecciona un rango de fechas válido.', 'error');
                    return;
                }
                
                currentDebtDates = getFridaysInPeriod(startDate, endDate);
                renderDebts();
            });

            addDebtBtn.addEventListener('click', () => openDebtModal());
            debtModalCloseBtn.addEventListener('click', () => closeDebtModal());
            debtForm.addEventListener('submit', handleDebtFormSubmit);
            debtModal.addEventListener('click', (e) => { if (e.target === debtModal) closeDebtModal(); });
            editDebtModeBtn.addEventListener('click', toggleEditModeDebts);
            deleteSelectedDebtsBtn.addEventListener('click', () => {
                const selectedCount = document.querySelectorAll('.debt-checkbox:checked').length;
                if (selectedCount > 0) {
                    showConfirmDeleteModal(null, 'debt');
                } else {
                    showNotification('Ninguna deuda seleccionada para eliminar', 'info');
                }
            });

            // Carga inicial de Deudas
            function initializeDebtsSection() {
                const today = new Date();
                const threeMonthsFromNow = new Date();
                threeMonthsFromNow.setMonth(today.getMonth() + 3);
                startDateDebtsInput.value = formatToYYYYMMDD(today);
                endDateDebtsInput.value = formatToYYYYMMDD(threeMonthsFromNow);
                
                loadDebts();
                generateDebtDatesBtn.click(); // Generar fechas y renderizar la tabla al cargar
            }
            
            initializeDebtsSection();


            // --- Lógica para Gastos Personales ---

            function loadGastos() {
                try {
                    const savedGastos = localStorage.getItem('gastosPersonales');
                    gastos = savedGastos ? JSON.parse(savedGastos) : [];
                    console.log("Gastos cargados:", gastos); // Debug log
                } catch (e) {
                    console.error("Error al cargar gastos de localStorage", e);
                    gastos = [];
                }
            }

            function saveGastos() {
                try {
                    localStorage.setItem('gastosPersonales', JSON.stringify(gastos));
                    console.log("Gastos guardados:", gastos); // Debug log
                } catch (e) {
                    console.error("Error al guardar gastos en localStorage", e);
                }
            }

            function calculateTotalGastos() {
                // Corrected syntax: (sum, gasto) =>
                const total = gastos.reduce((sum, gasto) => sum + parseFloat(gasto.amount), 0);
                totalGastosDisplay.textContent = `$${total.toFixed(2)}`;
            }

            function renderGastos() {
                gastosList.innerHTML = '';
                if (gastos.length === 0) {
                    gastosList.innerHTML = `<tr><td colspan="4" style="text-align: center; padding: 30px;">No hay gastos registrados</td></tr>`;
                    calculateTotalGastos();
                    return;
                }

                // Ordenar gastos por fecha (más reciente primero)
                gastos.sort((a, b) => new Date(b.date) - new Date(a.date));

                gastos.forEach(gasto => {
                    const row = document.createElement('tr');
                    row.dataset.id = gasto.id;
                    let rowContent = `
                        <td>${gasto.name}</td>
                        <td class="loan-amount">$${parseFloat(gasto.amount).toFixed(2)}</td>
                        <td>${gasto.date}</td>
                    `;
                    if (isEditModeGastos) {
                        rowContent = `
                            <td><input type="text" class="form-control" value="${gasto.name}" data-field="name" disabled></td>
                            <td><input type="number" class="form-control amount-input" value="${parseFloat(gasto.amount).toFixed(2)}" step="0.01" data-field="amount"></td>
                            <td><input type="date" class="form-control" value="${gasto.date}" data-field="date"></td>
                            <td><input type="checkbox" class="gasto-checkbox" data-id="${gasto.id}"></td>
                        `;
                    } else {
                        rowContent += `
                            <td class="loan-actions">
                                <button class="action-btn edit-btn" data-id="${gasto.id}"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" data-id="${gasto.id}"><i class="fas fa-trash-alt"></i></button>
                            </td>
                        `;
                    }
                    row.innerHTML = rowContent;
                    gastosList.appendChild(row);
                });
                calculateTotalGastos();
                if (!isEditModeGastos) {
                    addGastoRowEventListeners();
                }
            }

            function addGastoRowEventListeners() {
                gastosList.querySelectorAll('.edit-btn').forEach(button => {
                    button.onclick = () => openGastoModal(parseInt(button.dataset.id));
                });
                gastosList.querySelectorAll('.delete-btn').forEach(button => {
                    button.onclick = () => showConfirmDeleteModal(parseInt(button.dataset.id), 'gasto');
                });
            }

            function openGastoModal(gastoId = null) {
                currentEditId = gastoId;
                if (gastoId) {
                    gastoModalTitle.textContent = 'Editar Gasto';
                    const gasto = gastos.find(g => g.id === gastoId);
                    if (gasto) {
                        gastoIdInput.value = gasto.id;
                        gastoNameSelect.value = gasto.name;
                        gastoAmountInput.value = gasto.amount;
                        gastoDateInput.value = gasto.date;
                    }
                } else {
                    gastoModalTitle.textContent = 'Añadir Nuevo Gasto';
                    gastoForm.reset();
                    gastoIdInput.value = '';
                    gastoDateInput.value = formatToYYYYMMDD(new Date()); // Default to today
                }
                gastoModal.classList.add('active');
            }

            function closeGastoModal() {
                gastoModal.classList.remove('active');
                currentEditId = null;
            }

            function handleGastoFormSubmit(e) {
                e.preventDefault();
                const name = gastoNameSelect.value.trim();
                const amount = parseFloat(gastoAmountInput.value);
                const date = gastoDateInput.value;

                if (name === '' || isNaN(amount) || amount <= 0 || date === '') {
                    showNotification('Por favor completa todos los campos de gasto correctamente', 'error');
                    return;
                }

                if (currentEditId) {
                    const gastoIndex = gastos.findIndex(g => g.id === currentEditId);
                    if (gastoIndex !== -1) {
                        gastos[gastoIndex].name = name;
                        gastos[gastoIndex].amount = amount;
                        gastos[gastoIndex].date = date;
                        showNotification('Gasto actualizado con éxito', 'success');
                    }
                } else {
                    const newGasto = { id: Date.now(), name: name, amount: amount, date: date };
                    gastos.push(newGasto);
                    showNotification('Gasto añadido con éxito', 'success');
                }
                saveGastos();
                renderGastos();
                closeGastoModal();
            }

            function toggleEditModeGastos() {
                isEditModeGastos = !isEditModeGastos;
                if (isEditModeGastos) {
                    editGastoModeBtn.innerHTML = '<i class="fas fa-save"></i> Guardar Cambios';
                    editGastoModeBtn.classList.add('active');
                    addGastoBtn.style.display = 'none';
                    deleteSelectedGastosBtn.style.display = 'inline-flex';
                } else {
                    editGastoModeBtn.innerHTML = '<i class="fas fa-edit"></i> Editar Gastos';
                    editGastoModeBtn.classList.remove('active');
                    addGastoBtn.style.display = 'inline-flex';
                    deleteSelectedGastosBtn.style.display = 'none';
                    // Save changes from inline edits
                    gastosList.querySelectorAll('tr').forEach(row => {
                        const gastoId = parseInt(row.dataset.id);
                        const gastoIndex = gastos.findIndex(g => g.id === gastoId);
                        if (gastoIndex !== -1) {
                            gastos[gastoIndex].amount = parseFloat(row.querySelector('[data-field="amount"]').value) || 0;
                            gastos[gastoIndex].date = row.querySelector('[data-field="date"]').value;
                        }
                    });
                    saveGastos();
                    showNotification('Cambios en gastos guardados', 'success');
                }
                renderGastos();
            }

            function deleteSelectedGastos() {
                const selectedGastoIds = Array.from(document.querySelectorAll('.gasto-checkbox:checked'))
                                            .map(checkbox => parseInt(checkbox.dataset.id));
                if (selectedGastoIds.length > 0) {
                    gastos = gastos.filter(gasto => !selectedGastoIds.includes(gasto.id));
                }
            }

            // Event Listeners para Gastos Personales
            addGastoBtn.addEventListener('click', () => openGastoModal());
            gastoModalCloseBtn.addEventListener('click', () => closeGastoModal());
            gastoForm.addEventListener('submit', handleGastoFormSubmit);
            gastoModal.addEventListener('click', (e) => { if (e.target === gastoModal) closeGastoModal(); });
            editGastoModeBtn.addEventListener('click', toggleEditModeGastos);
            deleteSelectedGastosBtn.addEventListener('click', () => {
                const selectedCount = document.querySelectorAll('.gasto-checkbox:checked').length;
                if (selectedCount > 0) {
                    showConfirmDeleteModal(null, 'gasto');
                } else {
                    showNotification('Ningún gasto seleccionado para eliminar', 'info');
                }
            });

            loadGastos();
            renderGastos();

            // --- Lógica para Fechas de Pago ---

            function loadPagos() {
                try {
                    const savedPagos = localStorage.getItem('fechasDePago');
                    pagos = savedPagos ? JSON.parse(savedPagos) : initialPagos;
                    console.log("Fechas de pago cargadas:", pagos); // Debug log
                } catch (e) {
                    console.error("Error al cargar fechas de pago de localStorage", e);
                    pagos = initialPagos;
                }
            }

            function savePagos() {
                try {
                    localStorage.setItem('fechasDePago', JSON.stringify(pagos));
                    console.log("Fechas de pago guardadas:", pagos); // Debug log
                } catch (e) {
                    console.error("Error al guardar fechas de pago en localStorage", e);
                }
            }

            function renderPagos() {
                fechasPagoList.innerHTML = '';
                if (pagos.length === 0) {
                    fechasPagoList.innerHTML = `<tr><td colspan="3" style="text-align: center; padding: 30px;">No hay fechas de pago registradas</td></tr>`;
                    return;
                }
                pagos.forEach(pago => {
                    const row = document.createElement('tr');
                    row.dataset.id = pago.id;
                    let rowContent = `
                        <td>${pago.debtName}</td>
                        <td>${pago.paymentDate}</td>
                    `;
                    if (isEditModePagos) {
                        rowContent = `
                            <td><input type="text" class="form-control" value="${pago.debtName}" data-field="debtName"></td>
                            <td><input type="text" class="form-control" value="${pago.paymentDate}" data-field="paymentDate"></td>
                            <td><input type="checkbox" class="pago-checkbox" data-id="${pago.id}"></td>
                        `;
                    } else {
                        rowContent += `
                            <td class="loan-actions">
                                <button class="action-btn edit-btn" data-id="${pago.id}"><i class="fas fa-edit"></i></button>
                                <button class="action-btn delete-btn" data-id="${pago.id}"><i class="fas fa-trash-alt"></i></button>
                            </td>
                        `;
                    }
                    row.innerHTML = rowContent;
                    fechasPagoList.appendChild(row);
                });
                if (!isEditModePagos) {
                    addPagoRowEventListeners();
                }
            }

            function addPagoRowEventListeners() {
                fechasPagoList.querySelectorAll('.edit-btn').forEach(button => {
                    button.onclick = () => openPagoModal(parseInt(button.dataset.id));
                });
                fechasPagoList.querySelectorAll('.delete-btn').forEach(button => {
                    button.onclick = () => showConfirmDeleteModal(parseInt(button.dataset.id), 'pago');
                });
            }

            function openPagoModal(pagoId = null) {
                currentEditId = pagoId;
                if (pagoId) {
                    pagoModalTitle.textContent = 'Editar Fecha de Pago';
                    const pago = pagos.find(p => p.id === pagoId);
                    if (pago) {
                        pagoIdInput.value = pago.id;
                        pagoDebtNameInput.value = pago.debtName;
                        pagoDateInput.value = pago.paymentDate;
                    }
                } else {
                    pagoModalTitle.textContent = 'Añadir Nueva Fecha de Pago';
                    pagoForm.reset();
                    pagoIdInput.value = '';
                }
                pagoModal.classList.add('active');
            }

            function closePagoModal() {
                pagoModal.classList.remove('active');
                currentEditId = null;
            }

            function handlePagoFormSubmit(e) {
                e.preventDefault();
                const debtName = pagoDebtNameInput.value.trim();
                const paymentDate = pagoDateInput.value.trim();

                if (debtName === '' || paymentDate === '') {
                    showNotification('Por favor completa todos los campos de pago correctamente', 'error');
                    return;
                }

                if (currentEditId) {
                    const pagoIndex = pagos.findIndex(p => p.id === currentEditId);
                    if (pagoIndex !== -1) {
                        pagos[pagoIndex].debtName = debtName;
                        pagos[pagoIndex].paymentDate = paymentDate;
                        showNotification('Fecha de pago actualizada con éxito', 'success');
                    }
                } else {
                    const newPago = { id: Date.now(), debtName: debtName, paymentDate: paymentDate };
                    pagos.push(newPago);
                    showNotification('Fecha de pago añadida con éxito', 'success');
                }
                savePagos();
                renderPagos();
                closePagoModal();
            }

            function toggleEditModePagos() {
                isEditModePagos = !isEditModePagos;
                if (isEditModePagos) {
                    editPagoModeBtn.innerHTML = '<i class="fas fa-save"></i> Guardar Cambios';
                    editPagoModeBtn.classList.add('active');
                    addPagoBtn.style.display = 'none';
                    deleteSelectedPagosBtn.style.display = 'inline-flex';
                } else {
                    editPagoModeBtn.innerHTML = '<i class="fas fa-edit"></i> Editar Pagos';
                    editPagoModeBtn.classList.remove('active');
                    addPagoBtn.style.display = 'inline-flex';
                    deleteSelectedPagosBtn.style.display = 'none';
                    // Save changes from inline edits
                    fechasPagoList.querySelectorAll('tr').forEach(row => {
                        const pagoId = parseInt(row.dataset.id);
                        const pagoIndex = pagos.findIndex(p => p.id === pagoId);
                        if (pagoIndex !== -1) {
                            pagos[pagoIndex].debtName = row.querySelector('[data-field="debtName"]').value;
                            pagos[pagoIndex].paymentDate = row.querySelector('[data-field="paymentDate"]').value;
                        }
                    });
                    savePagos();
                    showNotification('Cambios en fechas de pago guardados', 'success');
                }
                renderPagos();
            }

            function deleteSelectedPagos() {
                const selectedPagoIds = Array.from(document.querySelectorAll('.pago-checkbox:checked'))
                                            .map(checkbox => parseInt(checkbox.dataset.id));
                if (selectedPagoIds.length > 0) {
                    pagos = pagos.filter(pago => !selectedPagoIds.includes(pago.id));
                }
            }

            // Event Listeners para Fechas de Pago
            addPagoBtn.addEventListener('click', () => openPagoModal());
            pagoModalCloseBtn.addEventListener('click', () => closePagoModal());
            pagoForm.addEventListener('submit', handlePagoFormSubmit);
            pagoModal.addEventListener('click', (e) => { if (e.target === pagoModal) closePagoModal(); });
            editPagoModeBtn.addEventListener('click', toggleEditModePagos);
            deleteSelectedPagosBtn.addEventListener('click', () => {
                const selectedCount = document.querySelectorAll('.pago-checkbox:checked').length;
                if (selectedCount > 0) {
                    showConfirmDeleteModal(null, 'pago');
                } else {
                    showNotification('Ninguna fecha de pago seleccionada para eliminar', 'info');
                }
            });

            loadPagos();
            renderPagos();

            // --- Lógica para el selector de categorías de Finanzas ---
            const financeCategoryBtns = document.querySelectorAll('.finance-category-btn');
            const financeSectionContents = document.querySelectorAll('.finance-section-content');

            function activateFinanceCategory(category) {
                financeCategoryBtns.forEach(btn => {
                    if (btn.dataset.financeCategory === category) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                financeSectionContents.forEach(content => {
                    if (content.classList.contains(`${category}-content`)) {
                        content.style.display = 'block';
                    } else {
                        content.style.display = 'none';
                    }
                });
            }

            financeCategoryBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    activateFinanceCategory(this.dataset.financeCategory);
                });
            });

            // Activar la primera categoría de finanzas por defecto al cargar
            activateFinanceCategory('debts');

            // --- Lógica para el selector de Rutinas de Ejercicio ---
            const routineBtns = document.querySelectorAll('.routine-btn');
            const routineContentContainers = document.querySelectorAll('.routine-content-container');

            function activateRoutineCategory(category) {
                routineBtns.forEach(btn => {
                    if (btn.dataset.routine === category) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                routineContentContainers.forEach(container => {
                    if (container.classList.contains(`${category}-routine`)) {
                        container.style.display = 'block';
                    } else {
                        container.style.display = 'none';
                    }
                });
            }

            routineBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    activateRoutineCategory(this.dataset.routine);
                });
            });

            // Activar la primera rutina de ejercicio por defecto al cargar
            activateRoutineCategory('upper-body');

            // --- Lógica para Pendientes ---
            const pendingCategoryBtns = document.querySelectorAll('.pending-btn');
            const pendingSectionContents = document.querySelectorAll('.pending-section-content');
            const pendingModal = document.getElementById('pending-modal');
            const pendingModalCloseBtn = pendingModal.querySelector('.close-modal');
            const pendingModalTitle = document.getElementById('pending-modal-title');
            const pendingModalCategoryDisplay = document.getElementById('pending-modal-category-display'); // New element for category display
            const pendingForm = document.getElementById('pending-form');
            const pendingIdInput = document.getElementById('pending-id');
            const pendingCategoryInput = document.getElementById('pending-category-input');
            const pendingTextInput = document.getElementById('pending-text');
            const pendingDateOptionSpecific = document.querySelector('input[name="pending-date-option"][value="specific"]');
            const pendingDateOptionIndefinite = document.querySelector('input[name="pending-date-option"][value="indefinite"]');
            const pendingDateInput = document.getElementById('pending-date-input');

            let allPendings = [];
            let currentPendingCategory = 'personales'; // Default category

            function loadPendings() {
                try {
                    const savedPendings = localStorage.getItem('allPendings');
                    allPendings = savedPendings ? JSON.parse(savedPendings) : [];
                    console.log("DEBUG: Pendientes cargados:", allPendings);
                } catch (e) {
                    console.error("ERROR: Error al cargar pendientes de localStorage", e);
                    allPendings = [];
                }
            }

            function savePendings() {
                try {
                    localStorage.setItem('allPendings', JSON.stringify(allPendings));
                    console.log("DEBUG: Pendientes guardados:", allPendings);
                } catch (e) {
                    console.error("ERROR: Error al guardar pendientes en localStorage", e);
                }
            }

            function renderPendings(category) {
                console.log(`DEBUG: Renderizando pendientes para categoría: ${category}`);
                currentPendingCategory = category;
                const targetListBody = document.getElementById(`${category}-pendings-list`);
                if (!targetListBody) {
                    console.error(`ERROR: No se encontró el tbody con ID: ${category}-pendings-list`);
                    return;
                }

                targetListBody.innerHTML = ''; // Clear existing rows

                const filteredPendings = allPendings.filter(p => p.category === category);
                console.log(`DEBUG: Pendientes filtrados para ${category}:`, filteredPendings);

                if (filteredPendings.length === 0) {
                    targetListBody.innerHTML = `<tr><td colspan="3" style="text-align: center; padding: 30px; color: #777;">No hay pendientes en esta categoría.</td></tr>`;
                    return;
                }

                filteredPendings.forEach(pending => {
                    const row = document.createElement('tr');
                    row.dataset.id = pending.id;
                    row.style.backgroundColor = '#f8f8f8'; // Light grey background for rows

                    const dateDisplay = pending.date ? new Date(pending.date).toLocaleDateString('es-ES', { day: '2-digit', month: 'short', year: 'numeric' }) : 'Indefinida';

                    row.innerHTML = `
                        <td>${pending.text}</td>
                        <td>${dateDisplay}</td>
                        <td class="loan-actions">
                            <button class="action-btn edit-btn" data-id="${pending.id}"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn" data-id="${pending.id}"><i class="fas fa-trash-alt"></i></button>
                        </td>
                    `;
                    targetListBody.appendChild(row);
                });
                addPendingItemEventListeners(category);
            }

            function addPendingItemEventListeners(category) {
                const targetListBody = document.getElementById(`${category}-pendings-list`);
                if (!targetListBody) return;

                targetListBody.querySelectorAll('.edit-btn').forEach(button => {
                    button.onclick = () => openPendingModal(parseInt(button.dataset.id));
                });
                targetListBody.querySelectorAll('.delete-btn').forEach(button => {
                    button.onclick = () => showConfirmDeleteModal(parseInt(button.dataset.id), 'pending');
                });
            }

            function openPendingModal(pendingId = null) {
                console.log(`DEBUG: Abriendo modal para pendiente ID: ${pendingId}, categoría actual: ${currentPendingCategory}`);
                currentEditId = pendingId;
                pendingForm.reset();
                pendingDateInput.style.display = 'block'; // Default to specific date

                if (pendingId) {
                    pendingModalTitle.textContent = 'Editar Pendiente';
                    const pending = allPendings.find(p => p.id === pendingId);
                    if (pending) {
                        pendingIdInput.value = pending.id;
                        pendingCategoryInput.value = pending.category; // Set category for editing
                        pendingTextInput.value = pending.text;
                        if (pending.date) {
                            pendingDateOptionSpecific.checked = true;
                            pendingDateInput.value = pending.date;
                            pendingDateInput.style.display = 'block';
                        } else {
                            pendingDateOptionIndefinite.checked = true;
                            pendingDateInput.value = '';
                            pendingDateInput.style.display = 'none';
                        }
                        // Update the display in the modal header
                        pendingModalCategoryDisplay.textContent = pending.category.charAt(0).toUpperCase() + pending.category.slice(1);
                    } else {
                        console.error(`ERROR: No se encontró el pendiente con ID: ${pendingId}`);
                    }
                } else {
                    pendingModalTitle.textContent = 'Agregar Nuevo Pendiente';
                    pendingIdInput.value = '';
                    pendingCategoryInput.value = currentPendingCategory; // Set category for new pending
                    pendingDateOptionSpecific.checked = true;
                    pendingDateInput.value = formatToYYYYMMDD(new Date()); // Default to today
                    // Update the display in the modal header
                    pendingModalCategoryDisplay.textContent = currentPendingCategory.charAt(0).toUpperCase() + currentPendingCategory.slice(1);
                }
                pendingModal.classList.add('active');
            }

            function closePendingModal() {
                pendingModal.classList.remove('active');
                currentEditId = null;
            }

            function handlePendingFormSubmit(e) {
                e.preventDefault();
                const text = pendingTextInput.value.trim();
                const category = pendingCategoryInput.value; // Get the category from the hidden input
                const isSpecificDate = pendingDateOptionSpecific.checked;
                const date = isSpecificDate ? pendingDateInput.value : null;

                console.log(`DEBUG: Intentando guardar pendiente. Categoría: ${category}, Texto: "${text}", Fecha: ${date}`);

                if (text === '') {
                    showNotification('La descripción del pendiente no puede estar vacía', 'error');
                    return;
                }
                if (isSpecificDate && date === '') {
                    showNotification('Por favor, selecciona una fecha para el pendiente', 'error');
                    return;
                }

                if (currentEditId) {
                    const pendingIndex = allPendings.findIndex(p => p.id === currentEditId);
                    if (pendingIndex !== -1) {
                        allPendings[pendingIndex].text = text;
                        allPendings[pendingIndex].date = date;
                        allPendings[pendingIndex].category = category; // Ensure category is updated if needed (though not directly editable in modal)
                        showNotification('Pendiente actualizado con éxito', 'success');
                        console.log("DEBUG: Pendiente actualizado:", allPendings[pendingIndex]);
                    } else {
                        console.error(`ERROR: No se encontró el pendiente para actualizar con ID: ${currentEditId}`);
                    }
                } else {
                    const newPending = { id: Date.now(), text: text, date: date, category: category };
                    allPendings.push(newPending);
                    showNotification('Pendiente añadido con éxito', 'success');
                    console.log("DEBUG: Nuevo pendiente añadido:", newPending);
                }
                savePendings();
                renderPendings(currentPendingCategory); // Re-render the active category
                closePendingModal();
            }

            function deletePendingTask(id) {
                console.log(`DEBUG: Intentando eliminar pendiente con ID: ${id}`);
                const initialLength = allPendings.length;
                allPendings = allPendings.filter(p => p.id !== id);
                if (allPendings.length < initialLength) {
                    showNotification('Pendiente eliminado con éxito', 'success');
                    console.log(`DEBUG: Pendiente ID ${id} eliminado.`);
                } else {
                    console.warn(`ADVERTENCIA: No se encontró el pendiente con ID: ${id} para eliminar.`);
                }
                savePendings();
                renderPendings(currentPendingCategory);
            }

            function checkUpcomingTasks() {
                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalize to start of day

                allPendings.forEach(pending => {
                    if (pending.date) {
                        const taskDate = new Date(pending.date);
                        taskDate.setHours(0, 0, 0, 0); // Normalize to start of day

                        const diffTime = taskDate.getTime() - today.getTime(); // Calculate difference in milliseconds
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); // Convert to days, rounding up

                        // Only notify if the task is today or in the future and within the next 7 days
                        if (diffDays >= 0 && diffDays <= 7) {
                            // Prevent multiple notifications for the same task on the same day
                            const lastNotifiedKey = `notified_${pending.id}_${taskDate.toISOString().slice(0,10)}`;
                            if (!localStorage.getItem(lastNotifiedKey)) {
                                let message = `Pendiente: "${pending.text}"`;
                                if (diffDays === 0) {
                                    message += ` es para HOY!`;
                                } else {
                                    message += ` en ${diffDays} día(s).`;
                                }
                                showNotification(message, 'info');
                                localStorage.setItem(lastNotifiedKey, 'true'); // Mark as notified
                            }
                        }
                    }
                });
            }

            // Event Listeners para Pendientes
            pendingCategoryBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const category = this.dataset.pendingCategory;
                    console.log(`DEBUG: Botón de categoría clicado: ${category}`);
                    pendingCategoryBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    pendingSectionContents.forEach(content => {
                        if (content.classList.contains(`${category}-pendings-content`)) {
                            content.style.display = 'block';
                        } else {
                            content.style.display = 'none';
                        }
                    });
                    currentPendingCategory = category; // Update the global variable
                    renderPendings(category); // Render tasks for the selected category
                });
            });

            // Botones para añadir pendientes por categoría
            document.getElementById('add-personal-pending-btn').addEventListener('click', () => {
                currentPendingCategory = 'personales';
                openPendingModal();
            });
            document.getElementById('add-escolar-pending-btn').addEventListener('click', () => {
                currentPendingCategory = 'escolares';
                openPendingModal();
            });
            document.getElementById('add-trabajo-pending-btn').addEventListener('click', () => {
                currentPendingCategory = 'trabajo';
                openPendingModal();
            });
            document.getElementById('add-financiero-pending-btn').addEventListener('click', () => {
                currentPendingCategory = 'financieros';
                openPendingModal();
            });

            pendingModalCloseBtn.addEventListener('click', closePendingModal);
            pendingModal.addEventListener('click', (e) => { if (e.target === pendingModal) closePendingModal(); });
            pendingForm.addEventListener('submit', handlePendingFormSubmit);

            // Toggle date input visibility based on radio button selection
            document.querySelectorAll('input[name="pending-date-option"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'specific') {
                        pendingDateInput.style.display = 'block';
                        pendingDateInput.setAttribute('required', 'required');
                        pendingDateInput.value = pendingDateInput.value || formatToYYYYMMDD(new Date()); // Set today if empty
                    } else {
                        pendingDateInput.style.display = 'none';
                        pendingDateInput.removeAttribute('required');
                        pendingDateInput.value = ''; // Clear date when indefinite
                    }
                });
            });

            // Initial load and render for Pendientes
            loadPendings();
            activateRoutineCategory('upper-body'); // Ensure this is called
            activateFinanceCategory('debts'); // Ensure this is called
            activatePendingCategory('personales'); // Activate default pending category
            
            // Run initial check for upcoming tasks
            checkUpcomingTasks();
            // Set interval to check for upcoming tasks every 5 minutes (300000 ms)
            setInterval(checkUpcomingTasks, 300000);

            function activatePendingCategory(category) {
                console.log(`DEBUG: Activando categoría de pendientes: ${category}`);
                pendingCategoryBtns.forEach(btn => {
                    if (btn.dataset.pendingCategory === category) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                });

                pendingSectionContents.forEach(content => {
                    if (content.classList.contains(`${category}-pendings-content`)) {
                        content.style.display = 'block';
                    } else {
                        content.style.display = 'none';
                    }
                });
                renderPendings(category);
            }

            // --- Lógica para la Calculadora de Gastos de Transporte Semanal ---
            const transportStartDateInput = document.getElementById('transportStartDate');
            const transportEndDateInput = document.getElementById('transportEndDate');
            const transportScheduleBody = document.getElementById('transportScheduleBody');
            const transportCalculateBtn = document.getElementById('transportCalculateBtn');
            const transportTotalExpenseSpan = document.getElementById('transportTotalExpense');
            const transportMessageModal = document.getElementById('transportMessageModal');
            const transportModalMessage = document.getElementById('transportModalMessage');
            const transportCloseModalBtn = document.getElementById('transportCloseModalBtn');
            const transportModalOkBtn = document.getElementById('transportModalOkBtn');

            // Función para mostrar la caja de mensaje personalizada de la calculadora
            function showTransportMessageBox(message) {
                transportModalMessage.textContent = message;
                transportMessageModal.style.display = 'flex';
            }

            // Event listeners para cerrar la caja de mensaje de la calculadora
            transportCloseModalBtn.addEventListener('click', () => {
                transportMessageModal.style.display = 'none';
            });
            transportModalOkBtn.addEventListener('click', () => {
                transportMessageModal.style.display = 'none';
            });
            transportMessageModal.addEventListener('click', (event) => {
                if (event.target == transportMessageModal) {
                    transportMessageModal.style.display = 'none';
                }
            });

            // Función para formatear una fecha a YYYY-MM-DD para el input type="date"
            function formatTransportDateForInput(date) {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }

            // Función para formatear una fecha para mostrarla (ej. "Viernes, 21 de Julio de 2025")
            function formatTransportDisplayDate(date) {
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                return date.toLocaleDateString('es-ES', options);
            }

            // Función para poblar la tabla del horario semanal de la calculadora
            function populateTransportSchedule() {
                transportScheduleBody.innerHTML = '';
                const dayNames = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado'];

                const start = new Date(transportStartDateInput.value + 'T00:00:00');
                const end = new Date(transportEndDateInput.value + 'T00:00:00');

                if (isNaN(start.getTime()) || isNaN(end.getTime())) {
                    return;
                }

                if (start > end) {
                    showTransportMessageBox('La fecha de inicio no puede ser posterior a la fecha de fin.');
                    return;
                }

                let currentDate = new Date(start);
                while (currentDate <= end) {
                    const row = document.createElement('tr');
                    row.classList.add('hover:bg-gray-50');

                    const dayOfWeek = dayNames[currentDate.getDay()];
                    const displayDate = formatTransportDisplayDate(currentDate);
                    const dateId = formatTransportDateForInput(currentDate);

                    row.innerHTML = `
                        <td class="py-3 px-4 text-sm text-gray-800 capitalize">${dayOfWeek}</td>
                        <td class="py-3 px-4 text-sm text-gray-600">${displayDate}</td>
                        <td class="py-3 px-4 text-sm text-gray-800">
                            <input type="checkbox" id="visit-${dateId}" class="form-checkbox h-5 w-5 text-indigo-600 rounded focus:ring-indigo-500" data-date="${dateId}">
                            <label for="visit-${dateId}" class="ml-2 text-gray-700 sr-only">Visitar novia</label>
                        </td>
                        <td class="py-3 px-4 text-sm text-gray-800">
                            <input type="checkbox" id="rest-${dateId}" class="form-checkbox h-5 w-5 text-indigo-600 rounded focus:ring-indigo-500" data-date="${dateId}">
                            <label for="rest-${dateId}" class="ml-2 text-gray-700 sr-only">Día de descanso</label>
                        </td>
                        <td class="py-3 px-4 text-sm text-gray-800">
                            <input type="checkbox" id="two-tickets-${dateId}" class="form-checkbox h-5 w-5 text-indigo-600 rounded focus:ring-indigo-500" data-date="${dateId}">
                            <label for="two-tickets-${dateId}" class="ml-2 text-gray-700 sr-only">Solo 2 Pasajes</label>
                        </td>
                    `;
                    transportScheduleBody.appendChild(row);

                    currentDate.setDate(currentDate.getDate() + 1);
                }
            }

            // Configuración inicial de la calculadora: Establecer la fecha actual como inicio y fin por defecto
            const transportToday = new Date();
            const transportNextFriday = new Date(transportToday);
            transportNextFriday.setDate(transportToday.getDate() + (5 + 7 - transportToday.getDay()) % 7);

            transportStartDateInput.value = formatTransportDateForInput(transportToday);
            transportEndDateInput.value = formatTransportDateForInput(transportNextFriday);
            populateTransportSchedule();

            // Event listeners para el cambio de fechas de inicio y fin de la calculadora
            transportStartDateInput.addEventListener('change', populateTransportSchedule);
            transportEndDateInput.addEventListener('change', populateTransportSchedule);

            // Event listener para el botón de cálculo de la calculadora
            transportCalculateBtn.addEventListener('click', () => {
                let totalExpense = 0;
                const rows = transportScheduleBody.querySelectorAll('tr');

                rows.forEach(row => {
                    const visitCheckbox = row.querySelector('[id^="visit-"]');
                    const restCheckbox = row.querySelector('[id^="rest-"]');
                    const twoTicketsCheckbox = row.querySelector('[id^="two-tickets-"]');

                    const isVisiting = visitCheckbox ? visitCheckbox.checked : false;
                    const isRestDay = restCheckbox ? restCheckbox.checked : false;
                    const usesTwoTickets = twoTicketsCheckbox ? twoTicketsCheckbox.checked : false;

                    let dailyCost = 0;

                    if (usesTwoTickets) {
                        dailyCost = 20;
                    } else if (isRestDay) {
                        if (isVisiting) {
                            dailyCost = 20;
                        } else {
                            dailyCost = 0;
                        }
                    } else {
                        if (isVisiting) {
                            dailyCost = 60;
                        } else {
                            dailyCost = 40;
                        }
                    }
                    totalExpense += dailyCost;
                });

                transportTotalExpenseSpan.textContent = totalExpense.toFixed(2);
            });
        });
    </script>
</body>
</html>                                                                                                                                                                                                                                                                                                                         
